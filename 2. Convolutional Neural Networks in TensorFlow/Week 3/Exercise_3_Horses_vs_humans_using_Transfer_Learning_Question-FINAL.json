{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "colab": {},
    "colab_type": "code",
    "id": "lbFmQdsZs5eW"
   },
   "outputs": [],
   "source": [
    "# ATTENTION: Please do not alter any of the provided code in the exercise. Only add your own code where indicated\n",
    "# ATTENTION: Please do not add or remove any cells in the exercise. The grader will check specific cells based on the cell position.\n",
    "# ATTENTION: Please use the provided epoch values when training.\n",
    "\n",
    "# Import all the necessary files!\n",
    "import os\n",
    "import tensorflow as tf\n",
    "from tensorflow.keras import layers\n",
    "from tensorflow.keras import Model\n",
    "from os import getcwd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "colab": {},
    "colab_type": "code",
    "id": "1xJZ5glPPCRz"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"inception_v3\"\n",
      "__________________________________________________________________________________________________\n",
      "Layer (type)                    Output Shape         Param #     Connected to                     \n",
      "==================================================================================================\n",
      "input_2 (InputLayer)            [(None, 150, 150, 3) 0                                            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_94 (Conv2D)              (None, 74, 74, 32)   864         input_2[0][0]                    \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_94 (BatchNo (None, 74, 74, 32)   96          conv2d_94[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "activation_94 (Activation)      (None, 74, 74, 32)   0           batch_normalization_94[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_95 (Conv2D)              (None, 72, 72, 32)   9216        activation_94[0][0]              \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_95 (BatchNo (None, 72, 72, 32)   96          conv2d_95[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "activation_95 (Activation)      (None, 72, 72, 32)   0           batch_normalization_95[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_96 (Conv2D)              (None, 72, 72, 64)   18432       activation_95[0][0]              \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_96 (BatchNo (None, 72, 72, 64)   192         conv2d_96[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "activation_96 (Activation)      (None, 72, 72, 64)   0           batch_normalization_96[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "max_pooling2d_4 (MaxPooling2D)  (None, 35, 35, 64)   0           activation_96[0][0]              \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_97 (Conv2D)              (None, 35, 35, 80)   5120        max_pooling2d_4[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_97 (BatchNo (None, 35, 35, 80)   240         conv2d_97[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "activation_97 (Activation)      (None, 35, 35, 80)   0           batch_normalization_97[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_98 (Conv2D)              (None, 33, 33, 192)  138240      activation_97[0][0]              \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_98 (BatchNo (None, 33, 33, 192)  576         conv2d_98[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "activation_98 (Activation)      (None, 33, 33, 192)  0           batch_normalization_98[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "max_pooling2d_5 (MaxPooling2D)  (None, 16, 16, 192)  0           activation_98[0][0]              \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_102 (Conv2D)             (None, 16, 16, 64)   12288       max_pooling2d_5[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_102 (BatchN (None, 16, 16, 64)   192         conv2d_102[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_102 (Activation)     (None, 16, 16, 64)   0           batch_normalization_102[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_100 (Conv2D)             (None, 16, 16, 48)   9216        max_pooling2d_5[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_103 (Conv2D)             (None, 16, 16, 96)   55296       activation_102[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_100 (BatchN (None, 16, 16, 48)   144         conv2d_100[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_103 (BatchN (None, 16, 16, 96)   288         conv2d_103[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_100 (Activation)     (None, 16, 16, 48)   0           batch_normalization_100[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_103 (Activation)     (None, 16, 16, 96)   0           batch_normalization_103[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_9 (AveragePoo (None, 16, 16, 192)  0           max_pooling2d_5[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_99 (Conv2D)              (None, 16, 16, 64)   12288       max_pooling2d_5[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_101 (Conv2D)             (None, 16, 16, 64)   76800       activation_100[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_104 (Conv2D)             (None, 16, 16, 96)   82944       activation_103[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_105 (Conv2D)             (None, 16, 16, 32)   6144        average_pooling2d_9[0][0]        \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_99 (BatchNo (None, 16, 16, 64)   192         conv2d_99[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_101 (BatchN (None, 16, 16, 64)   192         conv2d_101[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_104 (BatchN (None, 16, 16, 96)   288         conv2d_104[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_105 (BatchN (None, 16, 16, 32)   96          conv2d_105[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_99 (Activation)      (None, 16, 16, 64)   0           batch_normalization_99[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "activation_101 (Activation)     (None, 16, 16, 64)   0           batch_normalization_101[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_104 (Activation)     (None, 16, 16, 96)   0           batch_normalization_104[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_105 (Activation)     (None, 16, 16, 32)   0           batch_normalization_105[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed0 (Concatenate)            (None, 16, 16, 256)  0           activation_99[0][0]              \n",
      "                                                                 activation_101[0][0]             \n",
      "                                                                 activation_104[0][0]             \n",
      "                                                                 activation_105[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_109 (Conv2D)             (None, 16, 16, 64)   16384       mixed0[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_109 (BatchN (None, 16, 16, 64)   192         conv2d_109[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_109 (Activation)     (None, 16, 16, 64)   0           batch_normalization_109[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_107 (Conv2D)             (None, 16, 16, 48)   12288       mixed0[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_110 (Conv2D)             (None, 16, 16, 96)   55296       activation_109[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_107 (BatchN (None, 16, 16, 48)   144         conv2d_107[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_110 (BatchN (None, 16, 16, 96)   288         conv2d_110[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_107 (Activation)     (None, 16, 16, 48)   0           batch_normalization_107[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_110 (Activation)     (None, 16, 16, 96)   0           batch_normalization_110[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_10 (AveragePo (None, 16, 16, 256)  0           mixed0[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_106 (Conv2D)             (None, 16, 16, 64)   16384       mixed0[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_108 (Conv2D)             (None, 16, 16, 64)   76800       activation_107[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_111 (Conv2D)             (None, 16, 16, 96)   82944       activation_110[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_112 (Conv2D)             (None, 16, 16, 64)   16384       average_pooling2d_10[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_106 (BatchN (None, 16, 16, 64)   192         conv2d_106[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_108 (BatchN (None, 16, 16, 64)   192         conv2d_108[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_111 (BatchN (None, 16, 16, 96)   288         conv2d_111[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_112 (BatchN (None, 16, 16, 64)   192         conv2d_112[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_106 (Activation)     (None, 16, 16, 64)   0           batch_normalization_106[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_108 (Activation)     (None, 16, 16, 64)   0           batch_normalization_108[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_111 (Activation)     (None, 16, 16, 96)   0           batch_normalization_111[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_112 (Activation)     (None, 16, 16, 64)   0           batch_normalization_112[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed1 (Concatenate)            (None, 16, 16, 288)  0           activation_106[0][0]             \n",
      "                                                                 activation_108[0][0]             \n",
      "                                                                 activation_111[0][0]             \n",
      "                                                                 activation_112[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_116 (Conv2D)             (None, 16, 16, 64)   18432       mixed1[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_116 (BatchN (None, 16, 16, 64)   192         conv2d_116[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_116 (Activation)     (None, 16, 16, 64)   0           batch_normalization_116[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_114 (Conv2D)             (None, 16, 16, 48)   13824       mixed1[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_117 (Conv2D)             (None, 16, 16, 96)   55296       activation_116[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_114 (BatchN (None, 16, 16, 48)   144         conv2d_114[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_117 (BatchN (None, 16, 16, 96)   288         conv2d_117[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_114 (Activation)     (None, 16, 16, 48)   0           batch_normalization_114[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_117 (Activation)     (None, 16, 16, 96)   0           batch_normalization_117[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_11 (AveragePo (None, 16, 16, 288)  0           mixed1[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_113 (Conv2D)             (None, 16, 16, 64)   18432       mixed1[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_115 (Conv2D)             (None, 16, 16, 64)   76800       activation_114[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_118 (Conv2D)             (None, 16, 16, 96)   82944       activation_117[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_119 (Conv2D)             (None, 16, 16, 64)   18432       average_pooling2d_11[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_113 (BatchN (None, 16, 16, 64)   192         conv2d_113[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_115 (BatchN (None, 16, 16, 64)   192         conv2d_115[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_118 (BatchN (None, 16, 16, 96)   288         conv2d_118[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_119 (BatchN (None, 16, 16, 64)   192         conv2d_119[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_113 (Activation)     (None, 16, 16, 64)   0           batch_normalization_113[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_115 (Activation)     (None, 16, 16, 64)   0           batch_normalization_115[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_118 (Activation)     (None, 16, 16, 96)   0           batch_normalization_118[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_119 (Activation)     (None, 16, 16, 64)   0           batch_normalization_119[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed2 (Concatenate)            (None, 16, 16, 288)  0           activation_113[0][0]             \n",
      "                                                                 activation_115[0][0]             \n",
      "                                                                 activation_118[0][0]             \n",
      "                                                                 activation_119[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_121 (Conv2D)             (None, 16, 16, 64)   18432       mixed2[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_121 (BatchN (None, 16, 16, 64)   192         conv2d_121[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_121 (Activation)     (None, 16, 16, 64)   0           batch_normalization_121[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_122 (Conv2D)             (None, 16, 16, 96)   55296       activation_121[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_122 (BatchN (None, 16, 16, 96)   288         conv2d_122[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_122 (Activation)     (None, 16, 16, 96)   0           batch_normalization_122[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_120 (Conv2D)             (None, 7, 7, 384)    995328      mixed2[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_123 (Conv2D)             (None, 7, 7, 96)     82944       activation_122[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_120 (BatchN (None, 7, 7, 384)    1152        conv2d_120[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_123 (BatchN (None, 7, 7, 96)     288         conv2d_123[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_120 (Activation)     (None, 7, 7, 384)    0           batch_normalization_120[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_123 (Activation)     (None, 7, 7, 96)     0           batch_normalization_123[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "max_pooling2d_6 (MaxPooling2D)  (None, 7, 7, 288)    0           mixed2[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "mixed3 (Concatenate)            (None, 7, 7, 768)    0           activation_120[0][0]             \n",
      "                                                                 activation_123[0][0]             \n",
      "                                                                 max_pooling2d_6[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_128 (Conv2D)             (None, 7, 7, 128)    98304       mixed3[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_128 (BatchN (None, 7, 7, 128)    384         conv2d_128[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_128 (Activation)     (None, 7, 7, 128)    0           batch_normalization_128[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_129 (Conv2D)             (None, 7, 7, 128)    114688      activation_128[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_129 (BatchN (None, 7, 7, 128)    384         conv2d_129[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_129 (Activation)     (None, 7, 7, 128)    0           batch_normalization_129[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_125 (Conv2D)             (None, 7, 7, 128)    98304       mixed3[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_130 (Conv2D)             (None, 7, 7, 128)    114688      activation_129[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_125 (BatchN (None, 7, 7, 128)    384         conv2d_125[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_130 (BatchN (None, 7, 7, 128)    384         conv2d_130[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_125 (Activation)     (None, 7, 7, 128)    0           batch_normalization_125[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_130 (Activation)     (None, 7, 7, 128)    0           batch_normalization_130[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_126 (Conv2D)             (None, 7, 7, 128)    114688      activation_125[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_131 (Conv2D)             (None, 7, 7, 128)    114688      activation_130[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_126 (BatchN (None, 7, 7, 128)    384         conv2d_126[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_131 (BatchN (None, 7, 7, 128)    384         conv2d_131[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_126 (Activation)     (None, 7, 7, 128)    0           batch_normalization_126[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_131 (Activation)     (None, 7, 7, 128)    0           batch_normalization_131[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_12 (AveragePo (None, 7, 7, 768)    0           mixed3[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_124 (Conv2D)             (None, 7, 7, 192)    147456      mixed3[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_127 (Conv2D)             (None, 7, 7, 192)    172032      activation_126[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_132 (Conv2D)             (None, 7, 7, 192)    172032      activation_131[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_133 (Conv2D)             (None, 7, 7, 192)    147456      average_pooling2d_12[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_124 (BatchN (None, 7, 7, 192)    576         conv2d_124[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_127 (BatchN (None, 7, 7, 192)    576         conv2d_127[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_132 (BatchN (None, 7, 7, 192)    576         conv2d_132[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_133 (BatchN (None, 7, 7, 192)    576         conv2d_133[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_124 (Activation)     (None, 7, 7, 192)    0           batch_normalization_124[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_127 (Activation)     (None, 7, 7, 192)    0           batch_normalization_127[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_132 (Activation)     (None, 7, 7, 192)    0           batch_normalization_132[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_133 (Activation)     (None, 7, 7, 192)    0           batch_normalization_133[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed4 (Concatenate)            (None, 7, 7, 768)    0           activation_124[0][0]             \n",
      "                                                                 activation_127[0][0]             \n",
      "                                                                 activation_132[0][0]             \n",
      "                                                                 activation_133[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_138 (Conv2D)             (None, 7, 7, 160)    122880      mixed4[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_138 (BatchN (None, 7, 7, 160)    480         conv2d_138[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_138 (Activation)     (None, 7, 7, 160)    0           batch_normalization_138[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_139 (Conv2D)             (None, 7, 7, 160)    179200      activation_138[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_139 (BatchN (None, 7, 7, 160)    480         conv2d_139[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_139 (Activation)     (None, 7, 7, 160)    0           batch_normalization_139[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_135 (Conv2D)             (None, 7, 7, 160)    122880      mixed4[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_140 (Conv2D)             (None, 7, 7, 160)    179200      activation_139[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_135 (BatchN (None, 7, 7, 160)    480         conv2d_135[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_140 (BatchN (None, 7, 7, 160)    480         conv2d_140[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_135 (Activation)     (None, 7, 7, 160)    0           batch_normalization_135[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_140 (Activation)     (None, 7, 7, 160)    0           batch_normalization_140[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_136 (Conv2D)             (None, 7, 7, 160)    179200      activation_135[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_141 (Conv2D)             (None, 7, 7, 160)    179200      activation_140[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_136 (BatchN (None, 7, 7, 160)    480         conv2d_136[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_141 (BatchN (None, 7, 7, 160)    480         conv2d_141[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_136 (Activation)     (None, 7, 7, 160)    0           batch_normalization_136[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_141 (Activation)     (None, 7, 7, 160)    0           batch_normalization_141[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_13 (AveragePo (None, 7, 7, 768)    0           mixed4[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_134 (Conv2D)             (None, 7, 7, 192)    147456      mixed4[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_137 (Conv2D)             (None, 7, 7, 192)    215040      activation_136[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_142 (Conv2D)             (None, 7, 7, 192)    215040      activation_141[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_143 (Conv2D)             (None, 7, 7, 192)    147456      average_pooling2d_13[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_134 (BatchN (None, 7, 7, 192)    576         conv2d_134[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_137 (BatchN (None, 7, 7, 192)    576         conv2d_137[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_142 (BatchN (None, 7, 7, 192)    576         conv2d_142[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_143 (BatchN (None, 7, 7, 192)    576         conv2d_143[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_134 (Activation)     (None, 7, 7, 192)    0           batch_normalization_134[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_137 (Activation)     (None, 7, 7, 192)    0           batch_normalization_137[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_142 (Activation)     (None, 7, 7, 192)    0           batch_normalization_142[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_143 (Activation)     (None, 7, 7, 192)    0           batch_normalization_143[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed5 (Concatenate)            (None, 7, 7, 768)    0           activation_134[0][0]             \n",
      "                                                                 activation_137[0][0]             \n",
      "                                                                 activation_142[0][0]             \n",
      "                                                                 activation_143[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_148 (Conv2D)             (None, 7, 7, 160)    122880      mixed5[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_148 (BatchN (None, 7, 7, 160)    480         conv2d_148[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_148 (Activation)     (None, 7, 7, 160)    0           batch_normalization_148[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_149 (Conv2D)             (None, 7, 7, 160)    179200      activation_148[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_149 (BatchN (None, 7, 7, 160)    480         conv2d_149[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_149 (Activation)     (None, 7, 7, 160)    0           batch_normalization_149[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_145 (Conv2D)             (None, 7, 7, 160)    122880      mixed5[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_150 (Conv2D)             (None, 7, 7, 160)    179200      activation_149[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_145 (BatchN (None, 7, 7, 160)    480         conv2d_145[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_150 (BatchN (None, 7, 7, 160)    480         conv2d_150[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_145 (Activation)     (None, 7, 7, 160)    0           batch_normalization_145[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_150 (Activation)     (None, 7, 7, 160)    0           batch_normalization_150[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_146 (Conv2D)             (None, 7, 7, 160)    179200      activation_145[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_151 (Conv2D)             (None, 7, 7, 160)    179200      activation_150[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_146 (BatchN (None, 7, 7, 160)    480         conv2d_146[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_151 (BatchN (None, 7, 7, 160)    480         conv2d_151[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_146 (Activation)     (None, 7, 7, 160)    0           batch_normalization_146[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_151 (Activation)     (None, 7, 7, 160)    0           batch_normalization_151[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_14 (AveragePo (None, 7, 7, 768)    0           mixed5[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_144 (Conv2D)             (None, 7, 7, 192)    147456      mixed5[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_147 (Conv2D)             (None, 7, 7, 192)    215040      activation_146[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_152 (Conv2D)             (None, 7, 7, 192)    215040      activation_151[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_153 (Conv2D)             (None, 7, 7, 192)    147456      average_pooling2d_14[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_144 (BatchN (None, 7, 7, 192)    576         conv2d_144[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_147 (BatchN (None, 7, 7, 192)    576         conv2d_147[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_152 (BatchN (None, 7, 7, 192)    576         conv2d_152[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_153 (BatchN (None, 7, 7, 192)    576         conv2d_153[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_144 (Activation)     (None, 7, 7, 192)    0           batch_normalization_144[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_147 (Activation)     (None, 7, 7, 192)    0           batch_normalization_147[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_152 (Activation)     (None, 7, 7, 192)    0           batch_normalization_152[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_153 (Activation)     (None, 7, 7, 192)    0           batch_normalization_153[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed6 (Concatenate)            (None, 7, 7, 768)    0           activation_144[0][0]             \n",
      "                                                                 activation_147[0][0]             \n",
      "                                                                 activation_152[0][0]             \n",
      "                                                                 activation_153[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_158 (Conv2D)             (None, 7, 7, 192)    147456      mixed6[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_158 (BatchN (None, 7, 7, 192)    576         conv2d_158[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_158 (Activation)     (None, 7, 7, 192)    0           batch_normalization_158[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_159 (Conv2D)             (None, 7, 7, 192)    258048      activation_158[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_159 (BatchN (None, 7, 7, 192)    576         conv2d_159[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_159 (Activation)     (None, 7, 7, 192)    0           batch_normalization_159[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_155 (Conv2D)             (None, 7, 7, 192)    147456      mixed6[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_160 (Conv2D)             (None, 7, 7, 192)    258048      activation_159[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_155 (BatchN (None, 7, 7, 192)    576         conv2d_155[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_160 (BatchN (None, 7, 7, 192)    576         conv2d_160[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_155 (Activation)     (None, 7, 7, 192)    0           batch_normalization_155[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_160 (Activation)     (None, 7, 7, 192)    0           batch_normalization_160[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_156 (Conv2D)             (None, 7, 7, 192)    258048      activation_155[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_161 (Conv2D)             (None, 7, 7, 192)    258048      activation_160[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_156 (BatchN (None, 7, 7, 192)    576         conv2d_156[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_161 (BatchN (None, 7, 7, 192)    576         conv2d_161[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_156 (Activation)     (None, 7, 7, 192)    0           batch_normalization_156[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_161 (Activation)     (None, 7, 7, 192)    0           batch_normalization_161[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_15 (AveragePo (None, 7, 7, 768)    0           mixed6[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_154 (Conv2D)             (None, 7, 7, 192)    147456      mixed6[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_157 (Conv2D)             (None, 7, 7, 192)    258048      activation_156[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_162 (Conv2D)             (None, 7, 7, 192)    258048      activation_161[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_163 (Conv2D)             (None, 7, 7, 192)    147456      average_pooling2d_15[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_154 (BatchN (None, 7, 7, 192)    576         conv2d_154[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_157 (BatchN (None, 7, 7, 192)    576         conv2d_157[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_162 (BatchN (None, 7, 7, 192)    576         conv2d_162[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_163 (BatchN (None, 7, 7, 192)    576         conv2d_163[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_154 (Activation)     (None, 7, 7, 192)    0           batch_normalization_154[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_157 (Activation)     (None, 7, 7, 192)    0           batch_normalization_157[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_162 (Activation)     (None, 7, 7, 192)    0           batch_normalization_162[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_163 (Activation)     (None, 7, 7, 192)    0           batch_normalization_163[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed7 (Concatenate)            (None, 7, 7, 768)    0           activation_154[0][0]             \n",
      "                                                                 activation_157[0][0]             \n",
      "                                                                 activation_162[0][0]             \n",
      "                                                                 activation_163[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_166 (Conv2D)             (None, 7, 7, 192)    147456      mixed7[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_166 (BatchN (None, 7, 7, 192)    576         conv2d_166[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_166 (Activation)     (None, 7, 7, 192)    0           batch_normalization_166[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_167 (Conv2D)             (None, 7, 7, 192)    258048      activation_166[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_167 (BatchN (None, 7, 7, 192)    576         conv2d_167[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_167 (Activation)     (None, 7, 7, 192)    0           batch_normalization_167[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_164 (Conv2D)             (None, 7, 7, 192)    147456      mixed7[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_168 (Conv2D)             (None, 7, 7, 192)    258048      activation_167[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_164 (BatchN (None, 7, 7, 192)    576         conv2d_164[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_168 (BatchN (None, 7, 7, 192)    576         conv2d_168[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_164 (Activation)     (None, 7, 7, 192)    0           batch_normalization_164[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_168 (Activation)     (None, 7, 7, 192)    0           batch_normalization_168[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_165 (Conv2D)             (None, 3, 3, 320)    552960      activation_164[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_169 (Conv2D)             (None, 3, 3, 192)    331776      activation_168[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_165 (BatchN (None, 3, 3, 320)    960         conv2d_165[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_169 (BatchN (None, 3, 3, 192)    576         conv2d_169[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_165 (Activation)     (None, 3, 3, 320)    0           batch_normalization_165[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_169 (Activation)     (None, 3, 3, 192)    0           batch_normalization_169[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "max_pooling2d_7 (MaxPooling2D)  (None, 3, 3, 768)    0           mixed7[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "mixed8 (Concatenate)            (None, 3, 3, 1280)   0           activation_165[0][0]             \n",
      "                                                                 activation_169[0][0]             \n",
      "                                                                 max_pooling2d_7[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_174 (Conv2D)             (None, 3, 3, 448)    573440      mixed8[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_174 (BatchN (None, 3, 3, 448)    1344        conv2d_174[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_174 (Activation)     (None, 3, 3, 448)    0           batch_normalization_174[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_171 (Conv2D)             (None, 3, 3, 384)    491520      mixed8[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_175 (Conv2D)             (None, 3, 3, 384)    1548288     activation_174[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_171 (BatchN (None, 3, 3, 384)    1152        conv2d_171[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_175 (BatchN (None, 3, 3, 384)    1152        conv2d_175[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_171 (Activation)     (None, 3, 3, 384)    0           batch_normalization_171[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_175 (Activation)     (None, 3, 3, 384)    0           batch_normalization_175[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_172 (Conv2D)             (None, 3, 3, 384)    442368      activation_171[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_173 (Conv2D)             (None, 3, 3, 384)    442368      activation_171[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_176 (Conv2D)             (None, 3, 3, 384)    442368      activation_175[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_177 (Conv2D)             (None, 3, 3, 384)    442368      activation_175[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_16 (AveragePo (None, 3, 3, 1280)   0           mixed8[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_170 (Conv2D)             (None, 3, 3, 320)    409600      mixed8[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_172 (BatchN (None, 3, 3, 384)    1152        conv2d_172[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_173 (BatchN (None, 3, 3, 384)    1152        conv2d_173[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_176 (BatchN (None, 3, 3, 384)    1152        conv2d_176[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_177 (BatchN (None, 3, 3, 384)    1152        conv2d_177[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_178 (Conv2D)             (None, 3, 3, 192)    245760      average_pooling2d_16[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_170 (BatchN (None, 3, 3, 320)    960         conv2d_170[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_172 (Activation)     (None, 3, 3, 384)    0           batch_normalization_172[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_173 (Activation)     (None, 3, 3, 384)    0           batch_normalization_173[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_176 (Activation)     (None, 3, 3, 384)    0           batch_normalization_176[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_177 (Activation)     (None, 3, 3, 384)    0           batch_normalization_177[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_178 (BatchN (None, 3, 3, 192)    576         conv2d_178[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_170 (Activation)     (None, 3, 3, 320)    0           batch_normalization_170[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed9_0 (Concatenate)          (None, 3, 3, 768)    0           activation_172[0][0]             \n",
      "                                                                 activation_173[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "concatenate_2 (Concatenate)     (None, 3, 3, 768)    0           activation_176[0][0]             \n",
      "                                                                 activation_177[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "activation_178 (Activation)     (None, 3, 3, 192)    0           batch_normalization_178[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed9 (Concatenate)            (None, 3, 3, 2048)   0           activation_170[0][0]             \n",
      "                                                                 mixed9_0[0][0]                   \n",
      "                                                                 concatenate_2[0][0]              \n",
      "                                                                 activation_178[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_183 (Conv2D)             (None, 3, 3, 448)    917504      mixed9[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_183 (BatchN (None, 3, 3, 448)    1344        conv2d_183[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_183 (Activation)     (None, 3, 3, 448)    0           batch_normalization_183[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_180 (Conv2D)             (None, 3, 3, 384)    786432      mixed9[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_184 (Conv2D)             (None, 3, 3, 384)    1548288     activation_183[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_180 (BatchN (None, 3, 3, 384)    1152        conv2d_180[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_184 (BatchN (None, 3, 3, 384)    1152        conv2d_184[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_180 (Activation)     (None, 3, 3, 384)    0           batch_normalization_180[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_184 (Activation)     (None, 3, 3, 384)    0           batch_normalization_184[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_181 (Conv2D)             (None, 3, 3, 384)    442368      activation_180[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_182 (Conv2D)             (None, 3, 3, 384)    442368      activation_180[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_185 (Conv2D)             (None, 3, 3, 384)    442368      activation_184[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_186 (Conv2D)             (None, 3, 3, 384)    442368      activation_184[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_17 (AveragePo (None, 3, 3, 2048)   0           mixed9[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_179 (Conv2D)             (None, 3, 3, 320)    655360      mixed9[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_181 (BatchN (None, 3, 3, 384)    1152        conv2d_181[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_182 (BatchN (None, 3, 3, 384)    1152        conv2d_182[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_185 (BatchN (None, 3, 3, 384)    1152        conv2d_185[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_186 (BatchN (None, 3, 3, 384)    1152        conv2d_186[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_187 (Conv2D)             (None, 3, 3, 192)    393216      average_pooling2d_17[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_179 (BatchN (None, 3, 3, 320)    960         conv2d_179[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_181 (Activation)     (None, 3, 3, 384)    0           batch_normalization_181[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_182 (Activation)     (None, 3, 3, 384)    0           batch_normalization_182[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_185 (Activation)     (None, 3, 3, 384)    0           batch_normalization_185[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_186 (Activation)     (None, 3, 3, 384)    0           batch_normalization_186[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_187 (BatchN (None, 3, 3, 192)    576         conv2d_187[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_179 (Activation)     (None, 3, 3, 320)    0           batch_normalization_179[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed9_1 (Concatenate)          (None, 3, 3, 768)    0           activation_181[0][0]             \n",
      "                                                                 activation_182[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "concatenate_3 (Concatenate)     (None, 3, 3, 768)    0           activation_185[0][0]             \n",
      "                                                                 activation_186[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "activation_187 (Activation)     (None, 3, 3, 192)    0           batch_normalization_187[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed10 (Concatenate)           (None, 3, 3, 2048)   0           activation_179[0][0]             \n",
      "                                                                 mixed9_1[0][0]                   \n",
      "                                                                 concatenate_3[0][0]              \n",
      "                                                                 activation_187[0][0]             \n",
      "==================================================================================================\n",
      "Total params: 21,802,784\n",
      "Trainable params: 0\n",
      "Non-trainable params: 21,802,784\n",
      "__________________________________________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "path_inception = f\"{getcwd()}/../tmp2/inception_v3_weights_tf_dim_ordering_tf_kernels_notop.h5\"\n",
    "\n",
    "# Import the inception model  \n",
    "from tensorflow.keras.applications.inception_v3 import InceptionV3\n",
    "\n",
    "# Create an instance of the inception model from the local pre-trained weights\n",
    "local_weights_file = path_inception\n",
    "\n",
    "pre_trained_model = InceptionV3(input_shape = (150, 150, 3),\n",
    "                               include_top = False, # Remove dense layer before CONV layers\n",
    "                               weights = None)\n",
    "\n",
    "pre_trained_model.load_weights(local_weights_file)\n",
    "\n",
    "# Make all the layers in the pre-trained model non-trainable\n",
    "for layer in pre_trained_model.layers:\n",
    "    layer.trainable = False\n",
    "  \n",
    "\n",
    "pre_trained_model.summary()\n",
    "\n",
    "# Expected Output is extremely large, but should end with:\n",
    "\n",
    "#batch_normalization_v1_281 (Bat (None, 3, 3, 192)    576         conv2d_281[0][0]                 \n",
    "#__________________________________________________________________________________________________\n",
    "#activation_273 (Activation)     (None, 3, 3, 320)    0           batch_normalization_v1_273[0][0] \n",
    "#__________________________________________________________________________________________________\n",
    "#mixed9_1 (Concatenate)          (None, 3, 3, 768)    0           activation_275[0][0]             \n",
    "#                                                                 activation_276[0][0]             \n",
    "#__________________________________________________________________________________________________\n",
    "#concatenate_5 (Concatenate)     (None, 3, 3, 768)    0           activation_279[0][0]             \n",
    "#                                                                 activation_280[0][0]             \n",
    "#__________________________________________________________________________________________________\n",
    "#activation_281 (Activation)     (None, 3, 3, 192)    0           batch_normalization_v1_281[0][0] \n",
    "#__________________________________________________________________________________________________\n",
    "#mixed10 (Concatenate)           (None, 3, 3, 2048)   0           activation_273[0][0]             \n",
    "#                                                                 mixed9_1[0][0]                   \n",
    "#                                                                 concatenate_5[0][0]              \n",
    "#                                                                 activation_281[0][0]             \n",
    "#==================================================================================================\n",
    "#Total params: 21,802,784\n",
    "#Trainable params: 0\n",
    "#Non-trainable params: 21,802,784"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "colab": {},
    "colab_type": "code",
    "id": "CFsUlwdfs_wg"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "last layer output shape:  (None, 7, 7, 768)\n"
     ]
    }
   ],
   "source": [
    "last_layer = pre_trained_model.get_layer('mixed7')\n",
    "print('last layer output shape: ', last_layer.output_shape)\n",
    "last_output = last_layer.output\n",
    "\n",
    "# Expected Output:\n",
    "# ('last layer output shape: ', (None, 7, 7, 768))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "colab": {},
    "colab_type": "code",
    "id": "-bsWZWp5oMq9"
   },
   "outputs": [],
   "source": [
    "# Define a Callback class that stops training once accuracy reaches 97.0%\n",
    "class myCallback(tf.keras.callbacks.Callback):\n",
    "    def on_epoch_end(self, epoch, logs={}):\n",
    "        if(logs.get('accuracy')>0.97):\n",
    "            print(\"\\nReached 97.0% accuracy so cancelling training!\")\n",
    "            self.model.stop_training = True\n",
    "\n",
    "      "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "colab": {},
    "colab_type": "code",
    "id": "BMXb913pbvFg"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"model_2\"\n",
      "__________________________________________________________________________________________________\n",
      "Layer (type)                    Output Shape         Param #     Connected to                     \n",
      "==================================================================================================\n",
      "input_2 (InputLayer)            [(None, 150, 150, 3) 0                                            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_94 (Conv2D)              (None, 74, 74, 32)   864         input_2[0][0]                    \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_94 (BatchNo (None, 74, 74, 32)   96          conv2d_94[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "activation_94 (Activation)      (None, 74, 74, 32)   0           batch_normalization_94[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_95 (Conv2D)              (None, 72, 72, 32)   9216        activation_94[0][0]              \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_95 (BatchNo (None, 72, 72, 32)   96          conv2d_95[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "activation_95 (Activation)      (None, 72, 72, 32)   0           batch_normalization_95[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_96 (Conv2D)              (None, 72, 72, 64)   18432       activation_95[0][0]              \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_96 (BatchNo (None, 72, 72, 64)   192         conv2d_96[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "activation_96 (Activation)      (None, 72, 72, 64)   0           batch_normalization_96[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "max_pooling2d_4 (MaxPooling2D)  (None, 35, 35, 64)   0           activation_96[0][0]              \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_97 (Conv2D)              (None, 35, 35, 80)   5120        max_pooling2d_4[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_97 (BatchNo (None, 35, 35, 80)   240         conv2d_97[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "activation_97 (Activation)      (None, 35, 35, 80)   0           batch_normalization_97[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_98 (Conv2D)              (None, 33, 33, 192)  138240      activation_97[0][0]              \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_98 (BatchNo (None, 33, 33, 192)  576         conv2d_98[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "activation_98 (Activation)      (None, 33, 33, 192)  0           batch_normalization_98[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "max_pooling2d_5 (MaxPooling2D)  (None, 16, 16, 192)  0           activation_98[0][0]              \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_102 (Conv2D)             (None, 16, 16, 64)   12288       max_pooling2d_5[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_102 (BatchN (None, 16, 16, 64)   192         conv2d_102[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_102 (Activation)     (None, 16, 16, 64)   0           batch_normalization_102[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_100 (Conv2D)             (None, 16, 16, 48)   9216        max_pooling2d_5[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_103 (Conv2D)             (None, 16, 16, 96)   55296       activation_102[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_100 (BatchN (None, 16, 16, 48)   144         conv2d_100[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_103 (BatchN (None, 16, 16, 96)   288         conv2d_103[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_100 (Activation)     (None, 16, 16, 48)   0           batch_normalization_100[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_103 (Activation)     (None, 16, 16, 96)   0           batch_normalization_103[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_9 (AveragePoo (None, 16, 16, 192)  0           max_pooling2d_5[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_99 (Conv2D)              (None, 16, 16, 64)   12288       max_pooling2d_5[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_101 (Conv2D)             (None, 16, 16, 64)   76800       activation_100[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_104 (Conv2D)             (None, 16, 16, 96)   82944       activation_103[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_105 (Conv2D)             (None, 16, 16, 32)   6144        average_pooling2d_9[0][0]        \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_99 (BatchNo (None, 16, 16, 64)   192         conv2d_99[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_101 (BatchN (None, 16, 16, 64)   192         conv2d_101[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_104 (BatchN (None, 16, 16, 96)   288         conv2d_104[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_105 (BatchN (None, 16, 16, 32)   96          conv2d_105[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_99 (Activation)      (None, 16, 16, 64)   0           batch_normalization_99[0][0]     \n",
      "__________________________________________________________________________________________________\n",
      "activation_101 (Activation)     (None, 16, 16, 64)   0           batch_normalization_101[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_104 (Activation)     (None, 16, 16, 96)   0           batch_normalization_104[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_105 (Activation)     (None, 16, 16, 32)   0           batch_normalization_105[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed0 (Concatenate)            (None, 16, 16, 256)  0           activation_99[0][0]              \n",
      "                                                                 activation_101[0][0]             \n",
      "                                                                 activation_104[0][0]             \n",
      "                                                                 activation_105[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_109 (Conv2D)             (None, 16, 16, 64)   16384       mixed0[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_109 (BatchN (None, 16, 16, 64)   192         conv2d_109[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_109 (Activation)     (None, 16, 16, 64)   0           batch_normalization_109[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_107 (Conv2D)             (None, 16, 16, 48)   12288       mixed0[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_110 (Conv2D)             (None, 16, 16, 96)   55296       activation_109[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_107 (BatchN (None, 16, 16, 48)   144         conv2d_107[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_110 (BatchN (None, 16, 16, 96)   288         conv2d_110[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_107 (Activation)     (None, 16, 16, 48)   0           batch_normalization_107[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_110 (Activation)     (None, 16, 16, 96)   0           batch_normalization_110[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_10 (AveragePo (None, 16, 16, 256)  0           mixed0[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_106 (Conv2D)             (None, 16, 16, 64)   16384       mixed0[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_108 (Conv2D)             (None, 16, 16, 64)   76800       activation_107[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_111 (Conv2D)             (None, 16, 16, 96)   82944       activation_110[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_112 (Conv2D)             (None, 16, 16, 64)   16384       average_pooling2d_10[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_106 (BatchN (None, 16, 16, 64)   192         conv2d_106[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_108 (BatchN (None, 16, 16, 64)   192         conv2d_108[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_111 (BatchN (None, 16, 16, 96)   288         conv2d_111[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_112 (BatchN (None, 16, 16, 64)   192         conv2d_112[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_106 (Activation)     (None, 16, 16, 64)   0           batch_normalization_106[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_108 (Activation)     (None, 16, 16, 64)   0           batch_normalization_108[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_111 (Activation)     (None, 16, 16, 96)   0           batch_normalization_111[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_112 (Activation)     (None, 16, 16, 64)   0           batch_normalization_112[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed1 (Concatenate)            (None, 16, 16, 288)  0           activation_106[0][0]             \n",
      "                                                                 activation_108[0][0]             \n",
      "                                                                 activation_111[0][0]             \n",
      "                                                                 activation_112[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_116 (Conv2D)             (None, 16, 16, 64)   18432       mixed1[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_116 (BatchN (None, 16, 16, 64)   192         conv2d_116[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_116 (Activation)     (None, 16, 16, 64)   0           batch_normalization_116[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_114 (Conv2D)             (None, 16, 16, 48)   13824       mixed1[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_117 (Conv2D)             (None, 16, 16, 96)   55296       activation_116[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_114 (BatchN (None, 16, 16, 48)   144         conv2d_114[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_117 (BatchN (None, 16, 16, 96)   288         conv2d_117[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_114 (Activation)     (None, 16, 16, 48)   0           batch_normalization_114[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_117 (Activation)     (None, 16, 16, 96)   0           batch_normalization_117[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_11 (AveragePo (None, 16, 16, 288)  0           mixed1[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_113 (Conv2D)             (None, 16, 16, 64)   18432       mixed1[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_115 (Conv2D)             (None, 16, 16, 64)   76800       activation_114[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_118 (Conv2D)             (None, 16, 16, 96)   82944       activation_117[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_119 (Conv2D)             (None, 16, 16, 64)   18432       average_pooling2d_11[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_113 (BatchN (None, 16, 16, 64)   192         conv2d_113[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_115 (BatchN (None, 16, 16, 64)   192         conv2d_115[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_118 (BatchN (None, 16, 16, 96)   288         conv2d_118[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_119 (BatchN (None, 16, 16, 64)   192         conv2d_119[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_113 (Activation)     (None, 16, 16, 64)   0           batch_normalization_113[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_115 (Activation)     (None, 16, 16, 64)   0           batch_normalization_115[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_118 (Activation)     (None, 16, 16, 96)   0           batch_normalization_118[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_119 (Activation)     (None, 16, 16, 64)   0           batch_normalization_119[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed2 (Concatenate)            (None, 16, 16, 288)  0           activation_113[0][0]             \n",
      "                                                                 activation_115[0][0]             \n",
      "                                                                 activation_118[0][0]             \n",
      "                                                                 activation_119[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_121 (Conv2D)             (None, 16, 16, 64)   18432       mixed2[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_121 (BatchN (None, 16, 16, 64)   192         conv2d_121[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_121 (Activation)     (None, 16, 16, 64)   0           batch_normalization_121[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_122 (Conv2D)             (None, 16, 16, 96)   55296       activation_121[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_122 (BatchN (None, 16, 16, 96)   288         conv2d_122[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_122 (Activation)     (None, 16, 16, 96)   0           batch_normalization_122[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_120 (Conv2D)             (None, 7, 7, 384)    995328      mixed2[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_123 (Conv2D)             (None, 7, 7, 96)     82944       activation_122[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_120 (BatchN (None, 7, 7, 384)    1152        conv2d_120[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_123 (BatchN (None, 7, 7, 96)     288         conv2d_123[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_120 (Activation)     (None, 7, 7, 384)    0           batch_normalization_120[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_123 (Activation)     (None, 7, 7, 96)     0           batch_normalization_123[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "max_pooling2d_6 (MaxPooling2D)  (None, 7, 7, 288)    0           mixed2[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "mixed3 (Concatenate)            (None, 7, 7, 768)    0           activation_120[0][0]             \n",
      "                                                                 activation_123[0][0]             \n",
      "                                                                 max_pooling2d_6[0][0]            \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_128 (Conv2D)             (None, 7, 7, 128)    98304       mixed3[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_128 (BatchN (None, 7, 7, 128)    384         conv2d_128[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_128 (Activation)     (None, 7, 7, 128)    0           batch_normalization_128[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_129 (Conv2D)             (None, 7, 7, 128)    114688      activation_128[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_129 (BatchN (None, 7, 7, 128)    384         conv2d_129[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_129 (Activation)     (None, 7, 7, 128)    0           batch_normalization_129[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_125 (Conv2D)             (None, 7, 7, 128)    98304       mixed3[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_130 (Conv2D)             (None, 7, 7, 128)    114688      activation_129[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_125 (BatchN (None, 7, 7, 128)    384         conv2d_125[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_130 (BatchN (None, 7, 7, 128)    384         conv2d_130[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_125 (Activation)     (None, 7, 7, 128)    0           batch_normalization_125[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_130 (Activation)     (None, 7, 7, 128)    0           batch_normalization_130[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_126 (Conv2D)             (None, 7, 7, 128)    114688      activation_125[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_131 (Conv2D)             (None, 7, 7, 128)    114688      activation_130[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_126 (BatchN (None, 7, 7, 128)    384         conv2d_126[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_131 (BatchN (None, 7, 7, 128)    384         conv2d_131[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_126 (Activation)     (None, 7, 7, 128)    0           batch_normalization_126[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_131 (Activation)     (None, 7, 7, 128)    0           batch_normalization_131[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_12 (AveragePo (None, 7, 7, 768)    0           mixed3[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_124 (Conv2D)             (None, 7, 7, 192)    147456      mixed3[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_127 (Conv2D)             (None, 7, 7, 192)    172032      activation_126[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_132 (Conv2D)             (None, 7, 7, 192)    172032      activation_131[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_133 (Conv2D)             (None, 7, 7, 192)    147456      average_pooling2d_12[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_124 (BatchN (None, 7, 7, 192)    576         conv2d_124[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_127 (BatchN (None, 7, 7, 192)    576         conv2d_127[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_132 (BatchN (None, 7, 7, 192)    576         conv2d_132[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_133 (BatchN (None, 7, 7, 192)    576         conv2d_133[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_124 (Activation)     (None, 7, 7, 192)    0           batch_normalization_124[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_127 (Activation)     (None, 7, 7, 192)    0           batch_normalization_127[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_132 (Activation)     (None, 7, 7, 192)    0           batch_normalization_132[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_133 (Activation)     (None, 7, 7, 192)    0           batch_normalization_133[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed4 (Concatenate)            (None, 7, 7, 768)    0           activation_124[0][0]             \n",
      "                                                                 activation_127[0][0]             \n",
      "                                                                 activation_132[0][0]             \n",
      "                                                                 activation_133[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_138 (Conv2D)             (None, 7, 7, 160)    122880      mixed4[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_138 (BatchN (None, 7, 7, 160)    480         conv2d_138[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_138 (Activation)     (None, 7, 7, 160)    0           batch_normalization_138[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_139 (Conv2D)             (None, 7, 7, 160)    179200      activation_138[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_139 (BatchN (None, 7, 7, 160)    480         conv2d_139[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_139 (Activation)     (None, 7, 7, 160)    0           batch_normalization_139[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_135 (Conv2D)             (None, 7, 7, 160)    122880      mixed4[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_140 (Conv2D)             (None, 7, 7, 160)    179200      activation_139[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_135 (BatchN (None, 7, 7, 160)    480         conv2d_135[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_140 (BatchN (None, 7, 7, 160)    480         conv2d_140[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_135 (Activation)     (None, 7, 7, 160)    0           batch_normalization_135[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_140 (Activation)     (None, 7, 7, 160)    0           batch_normalization_140[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_136 (Conv2D)             (None, 7, 7, 160)    179200      activation_135[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_141 (Conv2D)             (None, 7, 7, 160)    179200      activation_140[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_136 (BatchN (None, 7, 7, 160)    480         conv2d_136[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_141 (BatchN (None, 7, 7, 160)    480         conv2d_141[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_136 (Activation)     (None, 7, 7, 160)    0           batch_normalization_136[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_141 (Activation)     (None, 7, 7, 160)    0           batch_normalization_141[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_13 (AveragePo (None, 7, 7, 768)    0           mixed4[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_134 (Conv2D)             (None, 7, 7, 192)    147456      mixed4[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_137 (Conv2D)             (None, 7, 7, 192)    215040      activation_136[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_142 (Conv2D)             (None, 7, 7, 192)    215040      activation_141[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_143 (Conv2D)             (None, 7, 7, 192)    147456      average_pooling2d_13[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_134 (BatchN (None, 7, 7, 192)    576         conv2d_134[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_137 (BatchN (None, 7, 7, 192)    576         conv2d_137[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_142 (BatchN (None, 7, 7, 192)    576         conv2d_142[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_143 (BatchN (None, 7, 7, 192)    576         conv2d_143[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_134 (Activation)     (None, 7, 7, 192)    0           batch_normalization_134[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_137 (Activation)     (None, 7, 7, 192)    0           batch_normalization_137[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_142 (Activation)     (None, 7, 7, 192)    0           batch_normalization_142[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_143 (Activation)     (None, 7, 7, 192)    0           batch_normalization_143[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed5 (Concatenate)            (None, 7, 7, 768)    0           activation_134[0][0]             \n",
      "                                                                 activation_137[0][0]             \n",
      "                                                                 activation_142[0][0]             \n",
      "                                                                 activation_143[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_148 (Conv2D)             (None, 7, 7, 160)    122880      mixed5[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_148 (BatchN (None, 7, 7, 160)    480         conv2d_148[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_148 (Activation)     (None, 7, 7, 160)    0           batch_normalization_148[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_149 (Conv2D)             (None, 7, 7, 160)    179200      activation_148[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_149 (BatchN (None, 7, 7, 160)    480         conv2d_149[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_149 (Activation)     (None, 7, 7, 160)    0           batch_normalization_149[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_145 (Conv2D)             (None, 7, 7, 160)    122880      mixed5[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_150 (Conv2D)             (None, 7, 7, 160)    179200      activation_149[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_145 (BatchN (None, 7, 7, 160)    480         conv2d_145[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_150 (BatchN (None, 7, 7, 160)    480         conv2d_150[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_145 (Activation)     (None, 7, 7, 160)    0           batch_normalization_145[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_150 (Activation)     (None, 7, 7, 160)    0           batch_normalization_150[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_146 (Conv2D)             (None, 7, 7, 160)    179200      activation_145[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_151 (Conv2D)             (None, 7, 7, 160)    179200      activation_150[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_146 (BatchN (None, 7, 7, 160)    480         conv2d_146[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_151 (BatchN (None, 7, 7, 160)    480         conv2d_151[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_146 (Activation)     (None, 7, 7, 160)    0           batch_normalization_146[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_151 (Activation)     (None, 7, 7, 160)    0           batch_normalization_151[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_14 (AveragePo (None, 7, 7, 768)    0           mixed5[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_144 (Conv2D)             (None, 7, 7, 192)    147456      mixed5[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_147 (Conv2D)             (None, 7, 7, 192)    215040      activation_146[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_152 (Conv2D)             (None, 7, 7, 192)    215040      activation_151[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_153 (Conv2D)             (None, 7, 7, 192)    147456      average_pooling2d_14[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_144 (BatchN (None, 7, 7, 192)    576         conv2d_144[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_147 (BatchN (None, 7, 7, 192)    576         conv2d_147[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_152 (BatchN (None, 7, 7, 192)    576         conv2d_152[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_153 (BatchN (None, 7, 7, 192)    576         conv2d_153[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_144 (Activation)     (None, 7, 7, 192)    0           batch_normalization_144[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_147 (Activation)     (None, 7, 7, 192)    0           batch_normalization_147[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_152 (Activation)     (None, 7, 7, 192)    0           batch_normalization_152[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_153 (Activation)     (None, 7, 7, 192)    0           batch_normalization_153[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed6 (Concatenate)            (None, 7, 7, 768)    0           activation_144[0][0]             \n",
      "                                                                 activation_147[0][0]             \n",
      "                                                                 activation_152[0][0]             \n",
      "                                                                 activation_153[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_158 (Conv2D)             (None, 7, 7, 192)    147456      mixed6[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_158 (BatchN (None, 7, 7, 192)    576         conv2d_158[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_158 (Activation)     (None, 7, 7, 192)    0           batch_normalization_158[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_159 (Conv2D)             (None, 7, 7, 192)    258048      activation_158[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_159 (BatchN (None, 7, 7, 192)    576         conv2d_159[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_159 (Activation)     (None, 7, 7, 192)    0           batch_normalization_159[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_155 (Conv2D)             (None, 7, 7, 192)    147456      mixed6[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_160 (Conv2D)             (None, 7, 7, 192)    258048      activation_159[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_155 (BatchN (None, 7, 7, 192)    576         conv2d_155[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_160 (BatchN (None, 7, 7, 192)    576         conv2d_160[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_155 (Activation)     (None, 7, 7, 192)    0           batch_normalization_155[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_160 (Activation)     (None, 7, 7, 192)    0           batch_normalization_160[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_156 (Conv2D)             (None, 7, 7, 192)    258048      activation_155[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_161 (Conv2D)             (None, 7, 7, 192)    258048      activation_160[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_156 (BatchN (None, 7, 7, 192)    576         conv2d_156[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_161 (BatchN (None, 7, 7, 192)    576         conv2d_161[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_156 (Activation)     (None, 7, 7, 192)    0           batch_normalization_156[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_161 (Activation)     (None, 7, 7, 192)    0           batch_normalization_161[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "average_pooling2d_15 (AveragePo (None, 7, 7, 768)    0           mixed6[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_154 (Conv2D)             (None, 7, 7, 192)    147456      mixed6[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_157 (Conv2D)             (None, 7, 7, 192)    258048      activation_156[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_162 (Conv2D)             (None, 7, 7, 192)    258048      activation_161[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "conv2d_163 (Conv2D)             (None, 7, 7, 192)    147456      average_pooling2d_15[0][0]       \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_154 (BatchN (None, 7, 7, 192)    576         conv2d_154[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_157 (BatchN (None, 7, 7, 192)    576         conv2d_157[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_162 (BatchN (None, 7, 7, 192)    576         conv2d_162[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "batch_normalization_163 (BatchN (None, 7, 7, 192)    576         conv2d_163[0][0]                 \n",
      "__________________________________________________________________________________________________\n",
      "activation_154 (Activation)     (None, 7, 7, 192)    0           batch_normalization_154[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_157 (Activation)     (None, 7, 7, 192)    0           batch_normalization_157[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_162 (Activation)     (None, 7, 7, 192)    0           batch_normalization_162[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "activation_163 (Activation)     (None, 7, 7, 192)    0           batch_normalization_163[0][0]    \n",
      "__________________________________________________________________________________________________\n",
      "mixed7 (Concatenate)            (None, 7, 7, 768)    0           activation_154[0][0]             \n",
      "                                                                 activation_157[0][0]             \n",
      "                                                                 activation_162[0][0]             \n",
      "                                                                 activation_163[0][0]             \n",
      "__________________________________________________________________________________________________\n",
      "flatten_2 (Flatten)             (None, 37632)        0           mixed7[0][0]                     \n",
      "__________________________________________________________________________________________________\n",
      "dense_4 (Dense)                 (None, 1024)         38536192    flatten_2[0][0]                  \n",
      "__________________________________________________________________________________________________\n",
      "dropout_2 (Dropout)             (None, 1024)         0           dense_4[0][0]                    \n",
      "__________________________________________________________________________________________________\n",
      "dense_5 (Dense)                 (None, 1)            1025        dropout_2[0][0]                  \n",
      "==================================================================================================\n",
      "Total params: 47,512,481\n",
      "Trainable params: 38,537,217\n",
      "Non-trainable params: 8,975,264\n",
      "__________________________________________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "from tensorflow.keras.optimizers import RMSprop\n",
    "\n",
    "# Flatten the output layer to 1 dimension\n",
    "x = layers.Flatten()(last_output)\n",
    "# Add a fully connected layer with 1,024 hidden units and ReLU activation\n",
    "x = layers.Dense(1024, activation = 'relu')(x)\n",
    "# Add a dropout rate of 0.2\n",
    "x = layers.Dropout(0.2)(x)                  \n",
    "# Add a final sigmoid layer for classification\n",
    "x = layers.Dense(1, activation = 'sigmoid')(x)           \n",
    "\n",
    "model = Model(pre_trained_model.input, x) \n",
    "\n",
    "model.compile(optimizer = RMSprop(lr=0.0001), \n",
    "              loss = 'binary_crossentropy', \n",
    "              metrics = ['accuracy'])\n",
    "\n",
    "model.summary()\n",
    "\n",
    "# Expected output will be large. Last few lines should be:\n",
    "\n",
    "# mixed7 (Concatenate)            (None, 7, 7, 768)    0           activation_248[0][0]             \n",
    "#                                                                  activation_251[0][0]             \n",
    "#                                                                  activation_256[0][0]             \n",
    "#                                                                  activation_257[0][0]             \n",
    "# __________________________________________________________________________________________________\n",
    "# flatten_4 (Flatten)             (None, 37632)        0           mixed7[0][0]                     \n",
    "# __________________________________________________________________________________________________\n",
    "# dense_8 (Dense)                 (None, 1024)         38536192    flatten_4[0][0]                  \n",
    "# __________________________________________________________________________________________________\n",
    "# dropout_4 (Dropout)             (None, 1024)         0           dense_8[0][0]                    \n",
    "# __________________________________________________________________________________________________\n",
    "# dense_9 (Dense)                 (None, 1)            1025        dropout_4[0][0]                  \n",
    "# ==================================================================================================\n",
    "# Total params: 47,512,481\n",
    "# Trainable params: 38,537,217\n",
    "# Non-trainable params: 8,975,264\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "colab": {},
    "colab_type": "code",
    "id": "HrnL_IQ8knWA"
   },
   "outputs": [],
   "source": [
    "# Get the Horse or Human dataset\n",
    "path_horse_or_human = f\"{getcwd()}/../tmp2/horse-or-human.zip\"\n",
    "# Get the Horse or Human Validation dataset\n",
    "path_validation_horse_or_human = f\"{getcwd()}/../tmp2/validation-horse-or-human.zip\"\n",
    "from tensorflow.keras.preprocessing.image import ImageDataGenerator\n",
    "\n",
    "import os\n",
    "import zipfile\n",
    "import shutil\n",
    "\n",
    "shutil.rmtree('/tmp')\n",
    "local_zip = path_horse_or_human\n",
    "zip_ref = zipfile.ZipFile(local_zip, 'r')\n",
    "zip_ref.extractall('/tmp/training')\n",
    "zip_ref.close()\n",
    "\n",
    "local_zip = path_validation_horse_or_human\n",
    "zip_ref = zipfile.ZipFile(local_zip, 'r')\n",
    "zip_ref.extractall('/tmp/validation')\n",
    "zip_ref.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "colab": {},
    "colab_type": "code",
    "id": "y9okX7_ovskI"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "500\n",
      "527\n",
      "128\n",
      "128\n"
     ]
    }
   ],
   "source": [
    "# Define our example directories and files\n",
    "train_dir = '/tmp/training'\n",
    "validation_dir = '/tmp/validation'\n",
    "\n",
    "train_horses_dir = os.path.join(train_dir, 'horses') # Your Code Here\n",
    "train_humans_dir = os.path.join(train_dir, 'humans') # Your Code Here\n",
    "validation_horses_dir = os.path.join(validation_dir, 'horses') # Your Code Here\n",
    "validation_humans_dir = os.path.join(validation_dir, 'humans') # Your Code Here\n",
    "\n",
    "train_horses_fnames = os.listdir(train_horses_dir)\n",
    "train_humans_fnames = os.listdir(train_humans_dir)\n",
    "validation_horses_fnames = os.listdir(validation_horses_dir)\n",
    "validation_humans_fnames = os.listdir(validation_humans_dir)\n",
    "\n",
    "print(len(train_horses_fnames))\n",
    "print(len(train_humans_fnames))\n",
    "print(len(validation_horses_fnames))\n",
    "print(len(validation_humans_fnames))\n",
    "\n",
    "# Expected Output:\n",
    "# 500\n",
    "# 527\n",
    "# 128\n",
    "# 128"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "colab": {},
    "colab_type": "code",
    "id": "O4s8HckqGlnb"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Found 1027 images belonging to 2 classes.\n",
      "Found 256 images belonging to 2 classes.\n"
     ]
    }
   ],
   "source": [
    "# Add our data-augmentation parameters to ImageDataGenerator\n",
    "train_datagen = ImageDataGenerator(rescale = 1./255,\n",
    "                                  rotation_range = 40,\n",
    "                                  width_shift_range = 0.2,\n",
    "                                  shear_range = 0.2,\n",
    "                                  zoom_range = 0.2,\n",
    "                                  horizontal_flip = True)\n",
    "\n",
    "# Note that the validation data should not be augmented!\n",
    "test_datagen = ImageDataGenerator(rescale = 1./255)\n",
    "\n",
    "# Flow training images in batches of 20 using train_datagen generator\n",
    "train_generator = train_datagen.flow_from_directory(train_dir,\n",
    "                                                   batch_size = 20,\n",
    "                                                   class_mode = 'binary',\n",
    "                                                   target_size = (150, 150))     \n",
    "\n",
    "# Flow validation images in batches of 20 using test_datagen generator\n",
    "validation_generator =  test_datagen.flow_from_directory(validation_dir,\n",
    "                                                        batch_size =  20,\n",
    "                                                        class_mode = 'binary',\n",
    "                                                        target_size = (150, 150))\n",
    "\n",
    "# Expected Output:\n",
    "# Found 1027 images belonging to 2 classes.\n",
    "# Found 256 images belonging to 2 classes."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "colab": {},
    "colab_type": "code",
    "id": "Blhq2MAUeyGA"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/3\n",
      "100/100 [==============================] - 100s 997ms/step - loss: 0.1534 - accuracy: 0.9392 - val_loss: 0.2371 - val_accuracy: 0.9575\n",
      "Epoch 2/3\n",
      " 99/100 [============================>.] - ETA: 0s - loss: 0.0298 - accuracy: 0.9898\n",
      "Reached 97.0% accuracy so cancelling training!\n",
      "100/100 [==============================] - 95s 955ms/step - loss: 0.0339 - accuracy: 0.9894 - val_loss: 0.0188 - val_accuracy: 0.9960\n"
     ]
    }
   ],
   "source": [
    "# Run this and see how many epochs it should take before the callback\n",
    "# fires, and stops training at 97% accuracy\n",
    "\n",
    "callbacks = myCallback()\n",
    "history = model.fit_generator(train_generator,\n",
    "                             validation_data = validation_generator,\n",
    "                             steps_per_epoch =100,\n",
    "                             epochs = 3,\n",
    "                             validation_steps = 50,\n",
    "                             verbose = 1,\n",
    "                             callbacks = [callbacks])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "colab": {},
    "colab_type": "code",
    "id": "C2Fp6Se9rKuL"
   },
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXoAAAEICAYAAABRSj9aAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAgAElEQVR4nO3deZyNdfvA8c+VJfsS2kwhScY+JilbFFFUtseaRyUl5JdUKkWeikqNQkWlUiFt0kaFHnooJmvIElPGOrZB1uH7++M6xjFmzBmz3HPOud6v17yc5T7nXPeZcZ37XN/vfX3FOYcxxpjQdZ7XARhjjMleluiNMSbEWaI3xpgQZ4neGGNCnCV6Y4wJcZbojTEmxFmiD0MikkdEDojI5Vm5rZdE5EoRyfK5wiJyk4jE+V1fIyINA9n2HF7rbRF54lwfb0xa8nodgEmfiBzwu1oIOAIc912/zzn3UUaezzl3HCiS1duGA+dc5ax4HhHpCXRzzt3g99w9s+K5jUnJEn0QcM4lJ1rfEWNP59yPaW0vInmdc0k5EZsx6bG/R+9Z6SYEiMizIvKxiEwWkf1ANxG5TkR+EZG9IrJVRF4TkXy+7fOKiBOR8r7rH/ru/05E9ovIAhGpkNFtffe3FJG1IpIoIqNF5H8i0iONuAOJ8T4RWS8ie0TkNb/H5hGRGBHZJSIbgBZneX+eFJEpKW4bKyKv+C73FJHVvv3503e0ndZzxYvIDb7LhUTkA19sK4E6KbYdLCIbfM+7UkRu891eHRgDNPSVxXb6vbdD/R5/v2/fd4nINBG5JJD3JiPv88l4RORHEdktIttE5FG/13nK957sE5FYEbk0tTKZiPx88vfsez/n+l5nNzBYRCqJyBzfa+z0vW/F/R5fzrePCb77XxWRAr6Yq/htd4mIHBSRUmntr0mFc85+gugHiANuSnHbs8BRoDX64V0QuAa4Fv3WdgWwFujr2z4v4IDyvusfAjuBaCAf8DHw4TlseyGwH7jdd98A4BjQI419CSTGL4HiQHlg98l9B/oCK4EIoBQwV/+cU32dK4ADQGG/594BRPuut/ZtI0BT4BBQw3ffTUCc33PFAzf4Lo8EfgJKAuWAVSm2/Rdwie930sUXw0W++3oCP6WI80NgqO9yc1+MtYACwOvA7EDemwy+z8WB7UB/4HygGFDXd9/jwDKgkm8fagEXAFemfK+Bn0/+nn37lgT0BvKgf49XATcC+X1/J/8DRvrtz+++97Owb/v6vvvGA8/5vc7DwBde/z8Mth/PA7CfDP7C0k70s9N53EDgE9/l1JL3m37b3gb8fg7b3g3M87tPgK2kkegDjLGe3/2fAwN9l+eiJayT992SMvmkeO5fgC6+yy2BNWfZ9mugj+/y2RL93/6/C+AB/21Ted7fgVt9l9NL9O8Dz/vdVwwdl4lI773J4Pt8J7Aoje3+PBlvitsDSfQb0omh/cnXBRoC24A8qWxXH9gIiO/6UqBtVv+/CvUfK92Ejk3+V0TkahH5xvdVfB8wDCh9lsdv87t8kLMPwKa17aX+cTj9nxmf1pMEGGNArwX8dZZ4ASYBnX2Xu/iun4yjlYj86isr7EWPps/2Xp10ydliEJEeIrLMV37YC1wd4POC7l/y8znn9gF7gLJ+2wT0O0vnfb4MTeipOdt96Un593ixiEwVkc2+GN5LEUOc04H/0zjn/od+O2ggItWAy4FvzjGmsGWJPnSknFo4Dj2CvNI5Vwx4Gj3Czk5b0SNOAEREOD0xpZSZGLeiCeKk9KZ/TgVuEpGyaGlpki/GgsCnwHC0rFIC+D7AOLalFYOIXAG8gZYvSvme9w+/501vKugWtBx08vmKoiWizQHEldLZ3udNQMU0HpfWff/4Yirkd9vFKbZJuX8voLPFqvti6JEihnIikieNOCYC3dBvH1Odc0fS2M6kwRJ96CoKJAL/+Aaz7suB1/waiBKR1iKSF637lsmmGKcC/yciZX0Dc4+dbWPn3Da0vPAeWrZZ57vrfLRunAAcF5FWaC050BieEJESoucZ9PW7rwia7BLQz7x70SP6k7YDEf6DoilMBu4RkRoicj76QTTPOZfmN6SzONv7PB24XET6isj5IlJMROr67nsbeFZEKoqqJSIXoB9w29BB/zwi0gu/D6WzxPAPkCgil6Hlo5MWALuA50UHuAuKSH2/+z9ASz1d0KRvMsgSfeh6GPg3Ojg6Dh00zVbOue1AR+AV9D9uRWAJeiSX1TG+AcwCVgCL0KPy9ExCa+7JZRvn3F7gIeALdECzPfqBFYgh6DeLOOA7/JKQc245MBpY6NumMvCr32N/ANYB20XEvwRz8vEz0BLLF77HXw50DTCulNJ8n51ziUAzoB364bMWaOy7+yVgGvo+70MHRgv4SnL3Ak+gA/NXpti31AwB6qIfONOBz/xiSAJaAVXQo/u/0d/Dyfvj0N/zEefc/Azuu+HUAIcxWc73VXwL0N45N8/reEzwEpGJ6ADvUK9jCUZ2wpTJUiLSAp3hcgidnncMPao15pz4xjtuB6p7HUuwstKNyWoNgA1obfpmoI0NnplzJSLD0bn8zzvn/vY6nmBlpRtjjAlxdkRvjDEhLtfV6EuXLu3Kly/vdRjGGBNUfvvtt53OuVSnM+e6RF++fHliY2O9DsMYY4KKiKR5driVbowxJsRZojfGmBBnid4YY0JcrqvRp+bYsWPEx8dz+PBhr0MxuUiBAgWIiIggX7602sUYYyBIEn18fDxFixalfPnyaENEE+6cc+zatYv4+HgqVKiQ/gOMCWNBUbo5fPgwpUqVsiRvkokIpUqVsm95xgQgKBI9YEnenMH+JowJTNAkemOMCVXHjsGUKfDWW9nz/JboA7Br1y5q1apFrVq1uPjiiylbtmzy9aNHjwb0HHfddRdr1qw56zZjx47lo48+yoqQjTFBYPdueOEFuOIK6NwZJkyA7Gg/FhSDsV4rVaoUS5cuBWDo0KEUKVKEgQMHnrZN8iK856X+2fnuu++m+zp9+vTJfLA5LCkpibx57c/ImIxYswZefRXefx8OHoSmTeGNN+CWWyA7KpJ2RJ8J69evJzIykq5du1K1alW2bt1Kr169iI6OpmrVqgwbNix52wYNGrB06VKSkpIoUaIEgwYNombNmlx33XXs2LEDgMGDBzNq1Kjk7QcNGkTdunWpXLky8+frwjr//PMP7dq1IzIykvbt2xMdHZ38IeRvyJAhXHPNNVSrVo3777+fk11K165dS9OmTalZsyZRUVHExcUB8Pzzz1O9enVq1qzJk08+eVrMANu2bePKK68E4O233+aOO+6gSZMm3Hzzzezbt4+mTZsSFRVFjRo1+PrrUws0vfvuu9SoUYOaNWty1113kZiYyBVXXEFSUhIAe/bsOe26MaHKOfjxR2jVCq6+Gt55Bzp2hGXLYNYsvT2N48RMC75Dsf/7P0glsWVKrVrgS7AZ9ccffzBx4kSio6MBGDFiBBdccAFJSUk0adKE9u3bExkZedpjEhMTady4MSNGjGDAgAFMmDCBQYMGnfHczjkWLlzI9OnTGTZsGDNmzGD06NFcfPHFfPbZZyxbtoyoqKhU4+rfvz/PPPMMzjm6dOnCjBkzaNmyJZ07d2bo0KG0bt2aw4cPc+LECb766iu+++47Fi5cSMGCBdm9e3e6+71kyRKWLl1KyZIlOXbsGNOmTaNYsWLs2LGD+vXr06pVK5YtW8YLL7zA/PnzueCCC9i9ezfFixenfv36zJgxg1atWjF58mQ6dOhg3wpMyDp8GCZN0hSzYgVceCEMHQr33w8XXZQzMdgRfSZVrFgxOckDTJ48maioKKKioli9ejWrVq064zEFCxakZcuWANSpUyf5qDqltm3bnrHNzz//TKdOnQCoWbMmVatWTfWxs2bNom7dutSsWZP//ve/rFy5kj179rBz505at24N6AlHhQoV4scff+Tuu++mYMGCAFxwwQXp7nfz5s0pWbIkoB9IgwYNokaNGjRv3pxNmzaxc+dOZs+eTceOHZOf7+S/PXv2TC5lvfvuu9x1113pvp4xwWb7dhgyBC6/HO65R2+bMAH++ktvz6kkD8F4RH+OR97ZpXDhwsmX161bx6uvvsrChQspUaIE3bp1S3Wed/78+ZMv58mTJ82yxfnnn5/uNqk5ePAgffv2ZfHixZQtW5bBgwef03zzvHnzcuLECYAzHu+/3xMnTiQxMZHFixeTN29eIiIizvp6jRs3pm/fvsyZM4d8+fJx9dVXZzg2Y3KrZcsgJgYmT4ajR7Uk89BD0KRJ9tTfA2FH9Flo3759FC1alGLFirF161ZmzpyZ5a9Rv359pk6dCsCKFStS/cZw6NAhzjvvPEqXLs3+/fv57LPPAChZsiRlypThq6++AjR5Hzx4kGbNmjFhwgQOHToEkFy6KV++PL/99hsAn376aZoxJSYmcuGFF5I3b15++OEHNm/eDEDTpk35+OOPk5/PvyTUrVs3unbtakfzJiScOAFffaWDqrVqwSefwL336qDrydu9PO3DEn0WioqKIjIykquvvpru3btTv379LH+Nfv36sXnzZiIjI3nmmWeIjIykePHip21TqlQp/v3vfxMZGUnLli259tprk+/76KOPePnll6lRowYNGjQgISGBVq1a0aJFC6Kjo6lVqxYxMTEAPPLII7z66qtERUWxZ8+eNGO68847mT9/PtWrV2fKlClUqlQJ0NLSo48+SqNGjahVqxaPPPJI8mO6du1KYmIiHTt2zMq3x5gcdeAAjBkDlSvDbbfBunU6XTI+Xm+/6iqvI1S5bs3Y6Ohol3LhkdWrV1OlShWPIspdkpKSSEpKokCBAqxbt47mzZuzbt26oBvMnDJlCjNnzgxo2unZ2N+G8cLff8Po0XqCU2IiXHutlmfatgWveuyJyG/OuejU7guu7GA4cOAAN954I0lJSTjnGDduXNAl+d69e/Pjjz8yY8YMr0MxJkMWLNBhQl81lHbtdCLgddd5G1d6gitDGEqUKJFcNw9Wb7zxhtchGBOwpCRN7DEx8OuvULy4Hr3366czaoKBJXpjjEnFnj1amhkzBjZtgiuv1HJNjx5QpIjX0WWMJXpjjPGzdq22J3jvPW1P0KQJjB0Lt96afWeuZjdL9MaYsOcczJmj5ZlvvtEB1S5doH9/nS4Z7CzRG2PC1uHDemLTqFGwfDmUKQNPPQW9e8PFF3sdXdYJ0i8iOatJkyZnnPw0atQoevfufdbHFfEV8rZs2UL79u1T3eaGG24g5XTSlEaNGsXBgweTr99yyy3s3bs3kNCNManYvh2eeQbKlYO779YTnt55R6dNPvNMaCV5sEQfkM6dOzNlypTTbpsyZQqdO3cO6PGXXnrpWc8sTU/KRP/tt99SokSJc36+nOacS26lYIyXli/XxH755dpY7Jpr4IcfTt1eoIDXEWYPS/QBaN++Pd98803yIiNxcXFs2bKFhg0bJs9rj4qKonr16nz55ZdnPD4uLo5q1aoB2p6gU6dOVKlShTZt2iS3HQCdX36yxfGQIUMAeO2119iyZQtNmjShSZMmgLYm2LlzJwCvvPIK1apVo1q1asktjuPi4qhSpQr33nsvVatWpXnz5qe9zklfffUV1157LbVr1+amm25i+/btgM7Vv+uuu6hevTo1atRIbqEwY8YMoqKiqFmzJjfeeCOg/flHjhyZ/JzVqlUjLi6OuLg4KleuTPfu3alWrRqbNm1Kdf8AFi1axPXXX0/NmjWpW7cu+/fvp1GjRqe1X27QoAHLli3L0O/NGNCj9a+/hhtvhJo14eOPtcnYH3/o7Tfd5G17ghxxcsGMs/0ALYA1wHpgUCr3lwNmAcuBn4AIv/teAH73/XRM77Xq1KnjUlq1alXy5f79nWvcOGt/+vc/4yXPcOutt7pp06Y555wbPny4e/jhh51zzh07dswlJiY655xLSEhwFStWdCdOnHDOOVe4cGHnnHMbN250VatWdc459/LLL7u77rrLOefcsmXLXJ48edyiRYucc87t2rXLOedcUlKSa9y4sVu2bJlzzrly5cq5hISE5FhOXo+NjXXVqlVzBw4ccPv373eRkZFu8eLFbuPGjS5PnjxuyZIlzjnnOnTo4D744IMz9mn37t3Jsb711ltuwIABzjnnHn30Udff703ZvXu327Fjh4uIiHAbNmw4LdYhQ4a4l156KXnbqlWruo0bN7qNGzc6EXELFixIvi+1/Tty5IirUKGCW7hwoXPOucTERHfs2DH33nvvJcewZs0al9rfhXOn/20Y4+/AAefGjHGuUiXnwLmyZZ0bMcI5359hyAFiXRp5Nd0jehHJA4wFWgKRQGcRiUyx2UhgonOuBjAMGO577K1AFFALuBYYKCLFzvVDyUv+5Rv/so1zjieeeIIaNWpw0003sXnz5uQj49TMnTuXbt26AVCjRg1q1KiRfN/UqVOJioqidu3arFy5MtWGZf5+/vln2rRpQ+HChSlSpAht27Zl3rx5AFSoUIFavukCabVCjo+P5+abb6Z69eq89NJLrFy5EoAff/zxtNWuSpYsyS+//EKjRo2oUKECEFgr43LlylGvXr2z7t+aNWu45JJLuOaaawAoVqwYefPmpUOHDnz99dccO3aMCRMm0KNHj3RfzxjQOe+PPQYREdC3L5QsqQOuGzfq7QH86YacQGbd1AXWO+c2AIjIFOB2wD8LRQIDfJfnANP8bp/rnEsCkkRkOfrtYOq5BuxVl+Lbb7+dhx56iMWLF3Pw4EHq1KkDaJOwhIQEfvvtN/Lly0f58uXPqSXwxo0bGTlyJIsWLaJkyZL06NHjnJ7npJMtjkHbHKdWuunXrx8DBgzgtttu46effmLo0KEZfh3/VsZwejtj/1bGGd2/QoUK0axZM7788kumTp0a9GcDm+z36686PfLTT3W6pH97gpAvzaQjkBp9WWCT3/V4323+lgFtfZfbAEVFpJTv9hYiUkhESgNNgMtSvoCI9BKRWBGJTUhIyOg+5IgiRYrQpEkT7r777tMGYU+26M2XLx9z5szhr7/+OuvzNGrUiEmTJgHw+++/s3z5ckBbHBcuXJjixYuzfft2vvvuu+THFC1alP3795/xXA0bNmTatGkcPHiQf/75hy+++IKGDRsGvE+JiYmULau/yvfffz/59mbNmjF27Njk63v27KFevXrMnTuXjRs3Aqe3Ml68eDEAixcvTr4/pbT2r3LlymzdupVFixYBsH///uTe+z179uTBBx/kmmuuSV7kxBh/SUkwdSpcfz3UqwfffafJfcOGU7eHe5KHrBuMHQg0FpElQGNgM3DcOfc98C0wH5gMLACOp3ywc268cy7aORddpkyZLAop63Xu3Jlly5adlui7du1KbGws1atXZ+LEiekuotG7d28OHDhAlSpVePrpp5O/GdSsWZPatWtz9dVX06VLl9NaHPfq1YsWLVokD8aeFBUVRY8ePahbty7XXnstPXv2pHbt2gHvz9ChQ+nQoQN16tShdOnSybcPHjyYPXv2UK1aNWrWrMmcOXMoU6YM48ePp23bttSsWTO5vXC7du3YvXs3VatWZcyYMVyVRl/WtPYvf/78fPzxx/Tr14+aNWvSrFmz5CP9OnXqUKxYMetZb86wdy+MHAkVK+q6qzt2wGuvaXvgkSN12mRQOXECPvhAeyxkh7SK9+7UYOp1wEy/648Dj59l+yJAfBr3TQJuOdvrpTcYa8LH5s2bXaVKldzx48fT3Mb+NsLLunXO9e3rXOHCOsDauLFz06Y5l5TkdWSZsGCBc3Xrntoh3wSJjCIzg7HAIqCSiFQQkfxAJ2C6/wYiUlpETj7X48AE3+15fCUcRKQGUAP4PhOfSyZMTJw4kWuvvZbnnnuO84K1wYjJEifbE9x2my7kMW6c1t8XL4affoLbb4c8ebyO8hzEx0PXrjqIsGkTvP8+zJ6dLbWmdAdjnXNJItIXmAnkASY451aKyDD0E2Q6cAMwXEQcMBc4OWUjHzBPNPB9QDenA7PGnFX37t3p3r2712EYDx05AlOm6ASMpUuhdGkYPFjbE1xyidfRZcLBg/DSS7oU1YkT8OSTMGhQtrbEDKjXjXPuW7TW7n/b036XPwXOOPXTOXcYnXmTac45xEZVjB+Xy1ZHM1ljxw548014/XVtVVC1qrYL7toVChb0OrpMcE4/uR57TI/gO3SAF1+E8uWz/aWDoqlZgQIF2LVrF6VKlbJkbwBN8rt27aJAqJ6zHoZWrNCj948+0qP5li11gY+QOHN10SKdDjR/PtSuDR9+CI0a5djLB0Wij4iIID4+ntw69dJ4o0CBAkRERHgdhsmEEydgxgyd//7jj3rEftdd8OCDEBJLAW/ZAk88ofX3Cy+Et9/WlUtyeFAhKBJ9vnz5ks/INMYEv3/+gYkTdYGPNWvg0kvh+eehVy8oVcrr6LLA4cPwyiu6U8eOwaOPai2+mDeNAYIi0RtjQkN8vC7NN368LtUXHa2lmg4ddLGPoOecLjD7yCMQFwdt2ujAa8WKnoZlid4Yk+0WLtT6+yefaLmmTRutv4fUmatLlmgdfu5cqFEDZs2Cpk29jgqwRG+MySZJSTBtmtbf58/XqsWDD2qjsZCqxG7frvM+33lH605vvgk9e+aqyf2W6I0xWSoxUcccR4+Gv/7SpD5qlA6yelSizh5Hjmjfhf/8Bw4d0q8oTz0FuXBRIEv0xpgs8eefOrj67rtw4IDOHhw1Clq3zlUHt5nnHHz5JQwcqDvdqhW8/LKetptLWaI3xpwz57QkHRMD06dD3rzQqZOWqqOivI4uG6xYoUfus2bp/M8ZM+Dmm72OKl2W6I0xGXbkiC7JN2qUjkGWKqXTxR94QKdKhpydO+Hpp7XRTvHiWpe6776gmSpkid4YE7CEhFPtCbZtg8hInSrZrVuQtydIy7FjMHYsPPMM7N8PffroquJBtkyVJXpjTLp+/13r7x9+qOcCtWih5ZnmzUNoemRK334LAwboGV0336wnQEVmSeuuHGeJ3hiTqhMnYOZMrb//8AMUKADdu0P//kGb7wKzerUm+BkzdID166/hlluC+hPNEr0x5jQHD55qT/DHH9oS+LnntD2B30JkoWf3bi3LvP66tgx+5RUt1eTP73VkmWaJ3hgDwObNWo4eN05zXlSUrm73r3+FRK5LW1KSDjwMGaJrFPbqBcOGQS5e1jSjLNEbE+ZiY7U8M3UqHD8Od9yhMwgbNAjqakVgvv9ed3bVKm1XEBOj7QtCjCV6Y8LQ8eOn2hP8739QtKi2JujXD664wuvocsDatfDww1p/r1gRvvhC1yQM0U82S/TGhJHERJgwQc/cj4vT9gQxMXD33SHWniAte/dqy4LRo3V0+YUXdHT5/PO9jixbWaI3Jgxs2KDJfcIEnQ7eoIGetR+0C2tn1PHj2oBn8GDYtUs/2Z57Di66yOvIcoQlemNClHMwb54esX/5pSb0jh11/nt0tNfR5aA5c3Snly8/1YCndm2vo8pRluiNCTFHj55qT7B4sZ7E+fjj2p6gbFmvo8tBGzZo47EvvtAFuD/5BNq1C9k6/NlYojcmROzcqVMjx46FrVvh6qt11uCdd0KhQl5Hl4P27dMl/GJitBfNc8/pCVBhvJC8JXpjgtyqVXr0/sEH2p6geXOtxTdvDued53V0Oej4cXjvPV2bdft2+Pe/NeGHZJe1jLFEb0wQck7bE4wapf8WKKBH7v37Q9WqXkfngXnzdOeXLNH1Cb/6Cq65xuuocg1L9MYEkUOH9Mh91ChtyXLxxTpb8L77QupEzsDFxcGjj2r9PSICJk3ShvhhWIc/G0v0xgSBLVtOtSfYtUsnjUycqLNoQro9QVoOHIARI2DkSK1PDR0KjzwSZoMRgQuogiciLURkjYisF5FBqdxfTkRmichyEflJRCL87ntRRFaKyGoReU3EPmqNCdRvv2lJpnx5GD4cGjaE//731O1hl+RPnNBPuMqVdZC1XTttIzxkiCX5s0g30YtIHmAs0BKIBDqLSMompSOBic65GsAwYLjvsdcD9YEaQDXgGqBxlkVvTAg6flxnBDZqpPPdp02D3r1h3bpTt4fl4dKCBXDddTrIWrYszJ8PH30El13mdWS5XiBH9HWB9c65Dc65o8AU4PYU20QCs32X5/jd74ACQH7gfCAfsD2zQRsTivbt09p7pUrQti38/beevRofry2DK1b0OkKPbNoEXbvqIOumTfD++/DLL5r0TUACSfRlgU1+1+N9t/lbBrT1XW4DFBWRUs65BWji3+r7memcW53yBUSkl4jEikhsQkJCRvfBmKC2caM2UIyI0H8vvRQ+/RTWr9fp38WLex2hRw4e1CX8KleGzz/X9gVr1+rqJ2E1bzTzsurdGgg0FpElaGlmM3BcRK4EqgAR6IdDUxFpmPLBzrnxzrlo51x0mbCcOmDCzcn2BO3awZVXwpgx0Lo1LFwIP/+st+cN16kSzsHkyXrG19Ch+sb88YdOLypSxOvoglIgf0qbAf8iWITvtmTOuS34juhFpAjQzjm3V0TuBX5xzh3w3fcdcB0wLwtiNyboHD2qMwFjYnRAtWRJnR3Yp48e0Ye9RYu0L838+Tq16KOPdATaZEogR/SLgEoiUkFE8gOdgOn+G4hIaRE5+VyPAxN8l/9Gj/Tzikg+9Gj/jNKNMaFu1y49SbNCBejWTWcHvvGGlpyHD7ckz5YtOshat67WrN5+W5O+Jfkske4RvXMuSUT6AjOBPMAE59xKERkGxDrnpgM3AMNFxAFzgT6+h38KNAVWoAOzM5xzX2X9bhiTO61erQOpEyfqyU7NmmkOu/lmKzMD2rPhlVf0U/DYMf168+STYdIcP+eIc87rGE4THR3tYmNjvQ7DmHPmHPzwg5ZnZszQNS26ddOKRLVqXkeXSzgHn32mJznFxUGbNvDSS2E8tSjzROQ351yqDajDdbjHmCx36BB8+KFOkVy1Ste0GDYM7r8/TNsTpGXJEv3UmztX12edNUvXazXZxhK9MZm0dSu8/rq2BN65E2rV0qneHTuG/Ap1GbN9u06RfOcdKFVK37CePcNkiStvWaI35hwtWaLlmSlTIClJZwE+9BA0bhymZ8iZomsAABz8SURBVK6m5cgRXcfwP//Rrz0PPQRPPQUlSngdWdiwRG9MBhw/rh1wY2K08lC4sJZmHnxQ58MbP87pGoYDB8Kff0KrVnqq71VXeR1Z2LFEb0wA9u/XxTxee01XqLv8cm2ceM89dmCaqhUr9Mh91iyIjNSm+c2bex1V2LJEb8xZxMXB6NE6JXLfPm23MmKEThIJ2zNXzyYhAZ5+GsaP10/A0aP1K4+9WZ6yd9+YFJzTEzNjYrRbpAh06KAHqHXreh1dLnX0qDbMf+YZPRusTx9tX3DBBV5HZrBEb0yyY8e0PcGoUXpSZsmSOs27Tx/rhJsm5+Dbb7X72tq1eibYK69oucbkGpboTdjbvVsrDWPGwObNOlY4dqyekV+4sNfR5WKrVmmCnzlT37Svv4ZbbrEpR7mQJXoTtv74Q9sTvP++zvq78UZdqq9lS2tPcFa7d2tZ5vXXtZtkTAw88EAYLncVPCzRm7DiHPz4o+am777TE5q6dtUTNatX9zq6XC4pSU9yGjIE9u7VFcmHDYPSpb2OzKTDEr0JC4cOwaRJWn///Xe48EIdN7z/fr1s0vH99zoavWqVfvWJibFPxiBiid6EtG3btMLwxhvanqBGDXj3Xejc2doTBGTtWnj4Ya2/V6yoC9jedpvV4YOMJXoTkpYu1aP3yZN1Nk2rVnpAesMNlqMCsnevlmVGj4aCBeHFF/X0X/t0DEqW6E3IOH4cvvlGqwo//QSFCsG990L//rrgtgnA8ePw1lvai2bXLj3199lntRWnCVqW6E3QO3BAyzGvvqotVS67TA9Ae/bUufAmQLNn66j0ihXQqJF+Japd2+uoTBawRG+C1l9/nWpPkJgI9erpQkVt29oZ9xny55/aeGzaNChfXs8aa9fOalwhxP47mKDiHCxYoAebn3+ut7Vvrwei9ep5G1vQ2bcPnntO38x8+fTygAFQoIDXkZksZoneBIVjx3TluZgYWLgQihfXnNS3r3aSNBlw/Di8956uzbp9u54C/PzzcOmlXkdmsoklepOr7dlzqj1BfLwOqo4Zo7mpSBGvowtC8+bp6PSSJdqK8+uvITrVZUZNCLFEb3KlNWu09/t778HBg7qk6Ouvw623WnuCcxIXB48+qvX3iAidd9qxo9Xhw4QlepNrOKcTP2JidJpk/vzQpYvW32vW9Dq6IHXggDbQHzlSPyGHDtWWnIUKeR2ZyUGW6I3nDh8+1Z5gxQooU0bbqfTubdO3z9mJE/DhhzBokK5e3qWLJnzrtxyWLNEbz2zffqo9QUKCtk6ZMEHbE9jEj0xYsEC/Bi1cCNdco6PY113ndVTGQ5boTY5btkyP3idN0oWJbr1V2xM0bWol40zZtEmP4CdNgksu0f7L3brZoIYhoL8AEWkhImtEZL2IDErl/nIiMktElovITyIS4bu9iYgs9fs5LCJ3ZPVOmNzvxAn46itN5rVqwdSpeubqmjU68ePGGy3Jn7ODB7UVZ+XKenLB4MHajKx7d0vyBgjgiF5E8gBjgWZAPLBIRKY751b5bTYSmOice19EmgLDgTudc3OAWr7nuQBYD3yfxftgcrEDB3TmzKuvwvr1OuHjhRc0ydtyopnkHEyZAo89pkfz//qX9n4oV87ryEwuE0jppi6w3jm3AUBEpgC3A/6JPhIY4Ls8B5iWyvO0B75zzh0893BNsPj7b53v/tZb2gixbl2d0deunZ6EaTJp0SKtw8+fD1FR8NFH0LCh11GZXCqQ73VlgU1+1+N9t/lbBrT1XW4DFBWRUim26QRMPpcgTfD45Rednn3FFfDyy9CsmeaiX3+FTp0syWfali16tljdutqj5p13dNDVkrw5i6wq4A0EGovIEqAxsBk4fvJOEbkEqA7MTO3BItJLRGJFJDYhISGLQjI5JSkJPv5Ye81cd52uFf3QQ7Bhg9bibcJHFjh0SHvRXHXVqXLN2rVw992QJ4/X0ZlcLpDSzWbAf/JthO+2ZM65LfiO6EWkCNDOObfXb5N/AV84546l9gLOufHAeIDo6GgXcPTGU3v2aOfI0aO1RFyxop7N2qMHFC3qdXQhwjn49FM9yemvv6BNG3jpJX2zjQlQIIl+EVBJRCqgCb4T0MV/AxEpDex2zp0AHgcmpHiOzr7bTQhYt04HV997D/75R1dtGjNGp0nawWUWWrJE6/Bz5+oaiLNnQ5MmXkdlglC6pRvnXBLQFy27rAamOudWisgwEbnNt9kNwBoRWQtcBDx38vEiUh79RvDfLI3c5KiT7Qlat9ZZfG+9pe2BlyyBOXN0GVFL8llk+3adllSnji7G/eabsHixJXlzzsS53FUpiY6OdrGxsV6HYXyOHDnVnmD5cm1P0Lu3/lx8sdfRhZgjR/Sr0rPPak3+wQd1Sb8SJbyOzAQBEfnNOZdqK1I7M9akascObU3w+ut6uVo1rcd37WrtCbKcc/Dll7rK059/6temkSN14NWYLGCJ3pxmxQrtHvnRR9qe4JZbdAaNnbmaTVas0Dr87NkQGalTlpo39zoqE2Is0RtOnIBvv9XyzKxZULAg3HOPVg6uvtrr6EJUQgI8/bSuqlKihI5m33efLXZrsoX9VYWxf/7RvlevvqpTssuWheHDoVcva0+QbY4ehbFjtTfNgQO6FuKQIfaGm2xliT4MbdqkB5Djx2t7gmuu0QHX9u3tzNVs45yupvLww/qp2qIFvPIKVKnidWQmDFiiDyO//qrlmU8+0bzTtq2Wh6+/3urv2WrVKh3o+P57nZv6zTc6+GFMDrFEH+KSkuCLL3SAdcECKFZM14bu1w/Kl/c6uhC3e7eWZd54Q08VjomBPn3sa5PJcZboQ9TevafaE/z9tzYZe/VVuOsua0+Q7Y4d05OchgyBxEQdZB02DEqX9joyE6Ys0YeY9eu138yECTrY2rixXm/Vys5czREnO7qtXq1zUmNidI1EYzxkiT4EOAc//aT196++0hl6nTpp/T0qyuvowsSaNTrQ+s032nBs2jTtC2GDHyYXsEQfxI4c0Y61o0bB0qVaGXjySXjgAV0y1OSAvXu1LDN6tJ6A8OKLegLC+ed7HZkxySzRB6EdO7QE/Prr2v8qMlKbjHXtqrnG5ICkJB0Eeeop2LVLzzB79lm46CKvIzPmDJbog8jvv+vR+4cf6tF8y5ZanmnWzCoEOWr2bH3jV6yARo30l1K7ttdRGZMmS/S53IkTMGOGjun9+KMesffooVMk7VybHPbnn9p4bNo0nZv6ySe6CK59yppczhJ9LvXPPzBxok6JXLMGLr0Unn9e2xOUSrkar8le+/bpMn6jRukc+OeegwEDrI2nCRqW6HOZ+HhthTJunC7VV6eOlmo6dID8+b2OLswcP67LaD35pA6G/Pvf+ml76aVeR2ZMhliizyUWLdLyzCefaLnmjjt0Onb9+lYZ8MS8eVofW7JEe0R8/TVEp7qmgzG5niV6DyUlabk3Jgbmz9czVvv1058KFbyOLkzFxcGjj+on7mWXweTJ0LGjfdqaoGaJ3gOJiafaE/z1lyb1mBi4+27tRWM8cOAAjBihKzudd562ER44EAoV8joyYzLNEn0O+vPPU+0JDhyAhg01wdvC2h46cQI++AAefxy2btWTEUaMgIgIryMzJstYos9mzsHcuZrQp0/XhH6yPUGdOl5HF+bmz9dfxKJFULcufP451KvndVTGZDlL9Nnk6NFT7QmWLNEFhB5/XLvU2qQNj23aBI89pvX3Sy/Veaxdu2rJxpgQZIk+i+3cqe0Jxo6Fbdv0pKZx46BbNyv3eu7gQe1F8+KL+lVr8GBN+EWKeB2ZMdnKEn0WWbnyVHuCw4fh5pt1Cnbz5jZhw3PO6dH7Y4/piQr/+pcm+3LlvI7MmBxhiT4TTpzQ9uMxMfDDD3qiZPfuOv06MtLr6Ayg9ff+/XV5ragoXRy3YUOvozImR1miPwcHD+pEjVGj4I8/tCXws8/qQkK2iFAusWWLDopMnKgdJd95R5sEWR3ehKGA/upFpIWIrBGR9SIyKJX7y4nILBFZLiI/iUiE332Xi8j3IrJaRFaJSPmsCz9nbd4MTzyh59Hcf7/W3D/4QM+xefJJS/K5wqFD2ovmqqt0NHzQIFi3Tk9SsCRvwlS6R/QikgcYCzQD4oFFIjLdObfKb7ORwETn3Psi0hQYDtzpu28i8Jxz7gcRKQKcyNI9yAGxsXr0/vHH2v7kjjt0Vl7DhlZ/zzWcg08/hUce0bPQ2raFl17SxXKNCXOBlG7qAuudcxsARGQKcDvgn+gjgQG+y3OAab5tI4G8zrkfAJxzB7Io7mx3/Dh8+aXW33/+WSdm9OmjiwdZ7shllizROvy8eVCjhvaLb9LE66iMyTUC+S5bFtjkdz3ed5u/ZUBb3+U2QFERKQVcBewVkc9FZImIvOT7hnAaEeklIrEiEpuQkJDxvchC+/Zpcr/ySm01Hh8Pr7yi/44aZUk+V9m2TVd2qlNHB0vGjYPFiy3JG5NCVhUtBwKNRWQJ0BjYDBxHvzE09N1/DXAF0CPlg51z451z0c656DJlymRRSBmzYYOWYyIitNV4RAR89pmWdx96CIoX9yQsk5ojR+CFF7QO/8EH+gtbt06b9VsvCWPOEEjpZjNwmd/1CN9tyZxzW/Ad0fvq8O2cc3tFJB5Y6lf2mQbUA97JgtgzzTn9tj9qlJZpzjtPp1g/9JB1pM2VnNN2nwMH6idz69bw8stQqZLXkRmTqwVyRL8IqCQiFUQkP9AJmO6/gYiUFpGTz/U4MMHvsSVE5ORhelNOr+174uhRPbEpOhoaN4b//lfPpYmLg48+siSfKy1fDjfeqIOsBQvC999r8yBL8sakK91E75xLAvoCM4HVwFTn3EoRGSYit/k2uwFYIyJrgYuA53yPPY6WbWaJyApAgLeyfC8CtHOnzrwrXx7uvFPnw7/5prY+ef55KJty5MF4LyFB57LWrg3LlsGYMbB0qa6IbowJiDjnvI7hNNHR0S42NjZLn3PVKl17deJEbU/QvLnW42++2aZW51pHj2pSHzZMezr36QNDhmh3OGPMGUTkN+dcqvWIkD0z1jn9dh8To20Kzj9fj+L/7/+galWvozNpcg6++QYefhjWroUWLXTaU5UqXkdmTNAKuUR/6NCp9gSrV8PFF8N//qPtCTya0GMCtWqVjoR//z1UrqwJ/5ZbvI7KmKAXMol+926dgDFuHOzapSXdiRN1Fs3553sdnTmr3bu1LPPGG7pwbkyMlmry5fM6MmNCQsgkeue0Dn/TTXpQ2KiRtSfI9Y4d09HwIUN0Id377tOavDUNMiZLhUyiL1UK/v7bxuqCxsyZ+om8erVOm4yJgerVvY7KmJAUUnNOLMkHgTVroFUrHWQ9elRPgPrhB0vyxmSjkEr0Jhfbu1dbFVSrpqcjv/SSLst1++1WYzMmm4VM6cbkUklJ8Pbb8NRTOkres6dOg7roIq8jMyZs2BG9yT6zZ+vyfb1768kLixfD+PGW5I3JYZboTdZbvx7atNFB1v37dUGQOXOgVi2vIzMmLFmiN1ln3z549FE9ev/hB20gtHq1Nva3OrwxnrEavcm848fh3Xd14dwdO3QR7uef11XTjTGes0RvMmfuXG0gtGQJ1K+vbQusz7MxuYqVbsy5iYuDDh20of/OnTB5sk6btCRvTK5jR/QmYw4cgOHDtbFQnjzwzDO64lOhQl5HZoxJgyV6E5gTJ7Qt6OOPw9at0LUrjBihi+saY3I1S/QmffPnax1+0SKoWxc+/xzq1fM6KmNMgKxGb9K2aRN06aKDrJs36xH9ggWW5I0JMnZEb8508CC8+KL+OKftCx57DAoX9joyY8w5sERvTnEOJk2CQYMgPh46doQXXoBy5byOzBiTCVa6MWrhQrj+eujWTXvRzJsHU6ZYkjcmBFiiD3ebN0P37nDttTo3fsIETfoNGngdmTEmi1jpJlwdOqRz4YcP11bCgwbBE0/omq3GmJBiiT7cOAeffKLNx/76C9q21UVArrjC68iMMdnESjfhZPFibVnQsSMUL6794j/7zJK8MSHOEn042LYN7rlH+9D88QeMG6dJv0kTryMzxuSAgBK9iLQQkTUisl5EBqVyfzkRmSUiy0XkJxGJ8LvvuIgs9f1Mz8rgTTqOHNHpkVddpSc7DRgA69ZBr17ap8YYExbSrdGLSB5gLNAMiAcWich059wqv81GAhOdc++LSFNgOHCn775DzjlbWignOQfTpmmzsQ0boHVrHXitVMnryIwxHgjkiL4usN45t8E5dxSYAtyeYptIYLbv8pxU7jc5ZflyXcKvbVsoWBC+/x6mT7ckb0wYCyTRlwU2+V2P993mbxnQ1ne5DVBUREr5rhcQkVgR+UVE7kjtBUSkl2+b2ISEhAyEb5IlJMD990Pt2rBsGYwZA0uXQrNmXkdmjPFYVg3GDgQai8gSoDGwGTjuu6+ccy4a6AKMEpGKKR/snBvvnIt2zkWXKVMmi0IKE0ePwiuv6BH7229D375ah+/TB/La7FljTGDz6DcDl/ldj/Ddlsw5twXfEb2IFAHaOef2+u7b7Pt3g4j8BNQG/sx05OHOOV227+GHYe1aaNFCE36VKl5HZozJZQI5ol8EVBKRCiKSH+gEnDZ7RkRKi8jJ53ocmOC7vaSInH9yG6A+4D+Ia87FqlWa2Fu3BhH49lv47jtL8saYVKWb6J1zSUBfYCawGpjqnFspIsNE5DbfZjcAa0RkLXAR8Jzv9ipArIgsQwdpR6SYrWMyYtcu6NcPatTQfjSjRsGKFdCypdeRGWNyMXHOeR3DaaKjo11sbKzXYeQux47Bm2/CkCGQmKiDrs88A6VLex2ZMSaXEJHffOOhZ7DRutxuxgw90Wn1arjpJoiJgWrVvI7KGBNErAVCbrVmDdx6q5Zljh2DL7/UOfGW5I0xGWSJPrfZswceekgT+s8/a2fJ33+H227TgVdjjMkgK93kFklJ8NZbuj7r7t3Qsyc8+yxceKHXkRljgpwd0ecGs2bpGa0PPKBH8osXw/jxluSNMVnCEr2X1q+HO+7QQdYDB+DTT2HOHKhlPeCMMVnHEr0X9u3TFZ4iI/Vo/vnndVZNu3ZWhzfGZDmr0eek48fh3XfhySe1CVmPHvDcc3DJJV5HZowJYZboc8rcudC/v3aUrF9f2xbUqeN1VMaYMGClm+y2cSN06KBrte7eDVOmwLx5luSNMTnGjuizy/79MHy4dpTMkweGDdMVnwoW9DoyY0yYsUSf1U6cgIkT4fHHdVHubt004UdEpP9YY4zJBpbos9L//gf/938QGwvXXgtffAH16nkdlTEmzFmNPiv8/Td07gwNGsCWLfDBBzB/viV5Y0yuYEf0mfHPP/Dii9qPxjltX/DYY1C4sNeRGWNMMkv058I5mDQJBg2C+Hjo2BFeeAHKlfM6MmOMOYOVbjJq4UK4/nodZL3oIp0qOWWKJXljTK5liT5QmzdD9+46yBoXBxMmaNJv0MDryIwx5qysdJOeQ4fg5Zd1imRSkpZrnngCihb1OjJjjAmIJfq0OAeffKLNx/76C9q21UHXK67wOjJjjMkQK92kZvFibVnQsSOUKKGtgz/7zJK8MSYoWaL3t20b3HMPREfDH3/AuHHw229www1eR2aMMefMSjcAR47AqFHaMvjwYXj4YRg8GIoX9zoyY4zJtPBO9M7BtGnabGzDBl2Ae+RIqFTJ68iMMSbLhG/pZvlyuPFGHWQtWBC+/x6+/NKSvDEm5IRfok9IgPvu08W4ly+HsWN1MZBmzbyOzBhjskVAiV5EWojIGhFZLyKDUrm/nIjMEpHlIvKTiESkuL+YiMSLyJisCjzDjh7V+fBXXqknO/XrB+vWwQMPQN7wrmAZY0JbuoleRPIAY4GWQCTQWUQiU2w2EpjonKsBDAOGp7j/P8DczId7DpyDr76CatW0Fl+/PqxYoYOvJUt6EpIxxuSkQI7o6wLrnXMbnHNHgSnA7Sm2iQRm+y7P8b9fROoAFwHfZz7cDFq5Em6+WQdZ8+TRdVq//RauvjrHQzHGGK8EkujLApv8rsf7bvO3DGjru9wGKCoipUTkPOBlYODZXkBEeolIrIjEJiQkBBb52ezaBX37Qs2asGiRHr0vXw4tW2b+uY0xJshk1WDsQKCxiCwBGgObgePAA8C3zrn4sz3YOTfeORftnIsuU6bMuUdx7Bi89prOnHnjDR10XbcO+veHfPnO/XmNMSaIBTIKuRm4zO96hO+2ZM65LfiO6EWkCNDOObdXRK4DGorIA0ARIL+IHHDOnTGgm2kbN8Ktt8Lq1XDTTRATo3V5Y4wJc4Ek+kVAJRGpgCb4TkAX/w1EpDSw2zl3AngcmADgnOvqt00PIDpbkjxA2bLai2bECGjdGkSy5WWMMSbYpJvonXNJItIXmAnkASY451aKyDAg1jk3HbgBGC4iDp1d0ycbY05d/vzw9dc5/rLGGJPbiXPO6xhOEx0d7WJjY70OwxhjgoqI/Oaci07tvvA7M9YYY8KMJXpjjAlxluiNMSbEWaI3xpgQZ4neGGNCnCV6Y4wJcZbojTEmxOW6efQikgD8lYmnKA3szKJwgkW47XO47S/YPoeLzOxzOedcqs3Ccl2izywRiU3rpIFQFW77HG77C7bP4SK79tlKN8YYE+Is0RtjTIgLxUQ/3usAPBBu+xxu+wu2z+EiW/Y55Gr0xhhjTheKR/TGGGP8WKI3xpgQF5SJXkRaiMgaEVkvImesWCUi54vIx777fxWR8jkfZdYKYJ8HiMgqEVkuIrNEpJwXcWal9PbZb7t2IuJEJOin4gWyzyLyL9/veqWITMrpGLNaAH/bl4vIHBFZ4vv7vsWLOLOKiEwQkR0i8nsa94uIvOZ7P5aLSFSmX9Q5F1Q/6CpXfwJXAPmBZUBkim0eAN70Xe4EfOx13Dmwz02AQr7LvcNhn33bFUVXNfsFXarS89iz+fdcCVgClPRdv9DruHNgn8cDvX2XI4E4r+PO5D43AqKA39O4/xbgO0CAesCvmX3NYDyirwusd85tcM4dBaYAt6fY5nbgfd/lT4EbRYJ6Edl099k5N8c5d9B39Rd0EfdgFsjvGeA/wAvA4ZwMLpsEss/3AmOdc3sAnHM7cjjGrBbIPjugmO9ycWBLDsaX5Zxzc4HdZ9nkdmCiU78AJUTkksy8ZjAm+rLAJr/r8b7bUt3GOZcEJAKlciS67BHIPvu7Bz0iCGbp7rPvK+1lzrlvcjKwbBTI7/kq4CoR+Z+I/CIiLXIsuuwRyD4PBbqJSDzwLdAvZ0LzTEb/v6cr3cXBTXARkW5ANNDY61iyk4icB7wC9PA4lJyWFy3f3IB+a5srItWdc3s9jSp7dQbec869LCLXAR+ISDXn3AmvAwsWwXhEvxm4zO96hO+2VLcRkbzo171dORJd9ghknxGRm4Angducc0dyKLbskt4+FwWqAT+JSBxay5we5AOygfye44HpzrljzrmNwFo08QerQPb5HmAqgHNuAVAAbf4VqgL6/54RwZjoFwGVRKSCiORHB1unp9hmOvBv3+X2wGznG+UIUunus4jUBsahST7Y67aQzj475xKdc6Wdc+Wdc+XRcYnbnHOx3oSbJQL5256GHs0jIqXRUs6GnAwyiwWyz38DNwKISBU00SfkaJQ5azrQ3Tf7ph6Q6JzbmpknDLrSjXMuSUT6AjPREfsJzrmVIjIMiHXOTQfeQb/erUcHPTp5F3HmBbjPLwFFgE98485/O+du8yzoTApwn0NKgPs8E2guIquA48Ajzrmg/bYa4D4/DLwlIg+hA7M9gvnATUQmox/WpX3jDkOAfADOuTfRcYhbgPXAQeCuTL9mEL9fxhhjAhCMpRtjjDEZYIneGGNCnCV6Y4wJcZbojTEmxFmiN8aYEGeJ3hhjQpwlemOMCXH/D/eNMi17li5qAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 432x288 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "acc = history.history['accuracy']\n",
    "val_acc = history.history['val_accuracy']\n",
    "loss = history.history['loss']\n",
    "val_loss = history.history['val_loss']\n",
    "\n",
    "epochs = range(len(acc))\n",
    "\n",
    "plt.plot(epochs, acc, 'r', label='Training accuracy')\n",
    "plt.plot(epochs, val_acc, 'b', label='Validation accuracy')\n",
    "plt.title('Training and validation accuracy')\n",
    "plt.legend(loc=0)\n",
    "plt.figure()\n",
    "\n",
    "\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Submission Instructions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Now click the 'Submit Assignment' button above."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# When you're done or would like to take a break, please run the two cells below to save your work and close the Notebook. This will free up resources for your fellow learners. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "%%javascript\n",
    "<!-- Save the notebook -->\n",
    "IPython.notebook.save_checkpoint();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "%%javascript\n",
    "IPython.notebook.session.delete();\n",
    "window.onbeforeunload = null\n",
    "setTimeout(function() { window.close(); }, 1000);"
   ]
  }
 ],
 "metadata": {
  "accelerator": "GPU",
  "colab": {
   "collapsed_sections": [],
   "name": "Exercise 7 - Question.ipynb",
   "provenance": []
  },
  "coursera": {
   "course_slug": "convolutional-neural-networks-tensorflow",
   "graded_item_id": "csg1x",
   "launcher_item_id": "GpKYz"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
